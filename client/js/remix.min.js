(function(f,k){function i(r,a,o){this.categories={};this.resources={};this.eventListeners=[];this.loadingCount=0;this.callbackQueue=[];this._head=b.getElementsByTagName("head")[0];r&&this.load(r,a,o)}var a,b=f.document,g=f.console;g===k&&(g={log:function(){}});var e=/^(([A-Za-z]+):\/\/)+(([a-zA-Z0-9\._\-]+\.[a-zA-Z]{2,6})|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})|localhost)(\:([0-9]+))*(\/[^#]*)?(\#.*)?$/;if(!Array.prototype.indexOf)Array.prototype.indexOf=function(r){if(this===void 0||this===
null)throw new TypeError;var b=Object(this),a=b.length>>>0;if(a===0)return-1;var c=0;arguments.length>0&&(c=Number(arguments[1]),c!==c?c=0:c!==0&&c!==1/0&&c!==-(1/0)&&(c=(c>0||-1)*Math.floor(Math.abs(c))));if(c>=a)return-1;for(c=c>=0?c:Math.max(a-Math.abs(c),0);c<a;c++)if(c in b&&b[c]===r)return c;return-1};f.Loaderator=i;i.Category=function(r,a){this.name=r;this.resources=[];this.resourcesById={};this.loader=a;this.eventListeners={load:[],single:{}}};i.Category.prototype.addResource=function(a){var b=
a.id||a.url;this.resourcesById[b]||(this.resources.push(a),this.resourcesById[b]=a,a.categories.push(this))};i.Category.prototype.checkForAllLoaded=function(){var a,b;if(this.loader.loadingCount)this.loader.callbackQueue.indexOf(this)<0&&this.loader.callbackQueue.push(this);else{var d=this.resources;if(a=d.length){var c=this.eventListeners.load;if(b=c.length){for(a--;a>=0;a--)if(!d[a].loaded)return;a=function(c,a,p){return function(){c.call(a,p)}};for(b--;b>=0;b--)d=c.pop(),d.async?setTimeout(a(d,
this.loader,this.resourcesById),0):d.call(this.loader,this.resourcesById)}}}};i.prototype.setBase=function(a){var d=b.getElementsByTagName("base"),o;this.base=null;if(a){if(a=e.exec(a))this.base={},this.base.protocol=a[2]+":",this.base.hostname=a[3],this.base.port=a[7]||"",this.base.host=this.base.hostname+(this.base.port?":"+this.base.port:""),this.base.pathname=a[8]}else for(o=0;o<d.length;o++)if(a=d.item(o),a=a.getAttribute("href"))if(a=e.exec(a)){this.base={};this.base.protocol=a[2]+":";this.base.hostname=
a[3];this.base.port=a[7]||"";this.base.host=this.base.hostname+(this.base.port?":"+this.base.port:"");this.base.pathname=a[8];break}if(!this.base)this.base={},this.base.protocol=f.location.protocol,this.base.host=f.location.host,this.base.port=f.location.port,this.base.hostname=f.location.hostname,this.base.pathname=f.location.pathname;d=this.base.pathname.split("?");d=d[0].split("/");d.pop();this.base.directory=d.join("/");return this};i.prototype.resolveUrl=function(a){this.base||this.setBase();
if(e.test(a))return a;var b=this.base,d=a.split("/");if(d.length&&d[0]==="")return b.protocol+"//"+b.host+a;var a=b.directory.split("/"),c;for(c=0;c<d.length;c++)d[c]===".."?a.pop():d[c]!=="."&&a.push(d[c]);return b.protocol+"//"+b.host+a.join("/")};var l=function(a,b){var d=!1;try{a.sheet&&a.sheet.cssRules.length>0?d=!0:a.styleSheet&&a.styleSheet.cssText.length>0?d=!0:a.innerHTML&&a.innerHTML.length>0&&(d=!0)}catch(c){}d?b():setTimeout(function(){l(a,b)},10)};i.prototype.loaders={script:function(a){var d=
this;if(!a.element){var e=b.createElement("script");e.type=a.mime||"text/javascript";e.id=a.id||a.categories[0].name+"-"+a.categories[0].resources.length;a.element=e;e.src=a.fullUrl;this._head.appendChild(e)}a.element.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState===4)a.loaded||d.resLoadCallback(a,this)};a.element.onload=function(){a.loaded||d.resLoadCallback(a,this)}},css:function(a){var d,e,c,g=b.getElementsByTagName("link");for(d=0,e=g.length;d<e;d++)if(c=g.item(d),
c.getAttribute("rel").toLowerCase()==="stylesheet"&&c.href===a.fullUrl){a.element=c;break}if(!a.element){var i=this;c=b.createElement("link");c.type=a.mime||"text/css";c.setAttribute("rel","stylesheet");c.id=a.id||a.categories[0].name+"-"+a.categories[0].resources.length;c.href=a.fullUrl;a.element=c;this._head.appendChild(c);l(c,function(){i.resLoadCallback(a,this)})}return!0},ajax:function(a){if(!a.element){var b=this,d=new XMLHttpRequest;a.element=d;d.open("GET",a.fullUrl,!0);d.onreadystatechange=
function(){d.readyState===4&&b.resLoadCallback(a,this)};d.send(null)}},object:function(a){var d,e=this,c;if(!a.element||!a.element.tagName){switch(a.type){case "audio":case "video":d=b.createElement(a.type);d.controls=a.controls||!1;d.loop=a.loop||!1;d.preload=a.preload||!1;d.autobuffer=d.preload;d.doMediaEvents=!0;d.id=a.id||a.categories[0].name+"-"+a.categories[0].resources.length;if(a.sources){if(Object.prototype.toString.call(a.sources)!=="[object Array]")a.sources=[a.sources];for(c=0;c<a.sources.length;c++){var i=
b.createElement("source");i.src=this.resolveUrl(a.sources[c]);d.appendChild(i)}}else d.src=a.fullUrl;d.doMediaEvents=!0;d.load();break;case "image":d=new Image;d.src=a.fullUrl;break;case "html":d=b.createElement("iframe");d.src=a.fullUrl;d.width=0;d.height=0;b.body.appendChild(d);break;default:return g.log("Resource Loader: unknown object type "+a.type),!1}a.element=d;if(!d.doMediaEvents)d.onload=function(c){e.resLoadCallback(a,c)}}else{a.type=a.element.tagName.toLowerCase();if(a.type==="img")a.type=
"image";else if(a.type==="iframe")a.type="html";else if(a.type==="audio"||a.type==="video")a.element.doMediaEvents=!0;else return g.log("Resource Loader: unknown object type "+a.type),!1;d=a.element}if(d.loaded)e.resLoadCallback(a,event);else if(d.doMediaEvents){d.addEventListener("canplay",function(c){a.loaded||e.resLoadCallback(a,c)},!0);var f=function(){d.readyState>=3?a.loaded||e.resLoadCallback(a,event):setTimeout(f,0)};f()}return!0},font:function(d){var e=this;a.load({url:this.base.protocol+
"//ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",id:"webfont-script",type:"script",mode:"script"},"webfont");a.addEventListener("webfont",function(){var a,c=d.families.concat([]),i,f,p=!1,s=[],m=b.getElementsByTagName("link");for(a=0,i=m.length;a<i;a++)if(f=m.item(a),f.getAttribute("rel").toLowerCase()==="stylesheet"&&(f=f.href,f===d.fullUrl)){p=!0;break}p||s.push(d.fullUrl);WebFont.load({custom:{families:d.families,urls:s},fontactive:function(p){for(a=0;a<c.length;a++)if(c[a]===p){c.splice(a,
1);break}c.length||e.resLoadCallback(d,this)},fontinactive:function(a){g.log("problem loading font:"+a)},inactive:function(){g.log("WebFonts are inactive!")},active:function(){}})})}};i.prototype.extensionTypes={js:"script",ogg:"audio",mp3:"audio",wav:"audio",ogv:"video",webm:"video",mp4:"video",jpg:"image",jpeg:"image",png:"image",gif:"image",css:"style",xml:"xml",xhtml:"xml",json:"json",txt:"text",html:"html"};i.prototype.load=function(a,b,d){if(Object.prototype.toString.call(a)!=="[object Array]")if(a)a=
[a];else return this;this.loadingCount+=1;var c,e,g,p,s,m=[];for(s=0;s<a.length;s++)if(c=a[s]){if(Object.prototype.toString.call(c)==="[object String]"||typeof c==="string")c={url:c};if(c.url){var j;c.fullUrl===k&&(j=this.resolveUrl(c.url));g="";if((e=this.resources[j])&&(!c.mode||c.mode===e.mode))a[s]=e;else{e&&(g="#"+c.mode);e=c;e.Loaderator=this;this.resources[j+g]=e;e.fullUrl=j;if(!c.type)g=c.fullUrl.split("."),g.length>1&&(g=g.pop().toLowerCase()),c.type=this.extensionTypes[g]||"text";if(!c.mode)switch(c.type){case "script":c.mode=
"script";break;case "style":case "css":c.mode="css";break;case "audio":case "video":case "image":case "html":c.mode="object";break;case "xml":case "json":case "text":c.mode="ajax";break;default:c.mode="ajax"}}}else e=c.loader?c:!1;g=[];b&&g.push(b);var x;if(c.category){p=Object.prototype.toString.call(c.category)==="[object Array]"?c.category:[c.category];for(c=0;c<p.length;c++)x=p[c],g.indexOf(x)<0&&g.push(x)}g.length||g.push(e.fullUrl);if(e&&g.length&&(e.loader||e.mode&&this.loaders[e.mode])){for(c=
0;c<g.length;c++){x=g[c];p=this.categories[x]||(this.categories[x]=new i.Category(x,this));if(e.categories===k)e.categories=[];p.addResource(e)}e.loader||e.fullUrl&&this.loaders[e.mode].call(this,e)&&m.push(e)}}d!==k&&Object.prototype.toString.call(d)==="[object Function]"&&b!==k&&this.addEventListener(b,d);for(this.loadingCount-=1;this.callbackQueue.length;)this.callbackQueue.splice(0,1)[0].checkForAllLoaded();return this};i.prototype.resLoadCallback=function(a,b){a.loaded=!0;a.event=b;var d,c;c=
this.eventListeners.length;for(d=0;d<c;d++)this.eventListeners[d].call(this,a);var e=function(a,c,p){return function(){a.call(c,p)}};c=a.categories.length;var g;for(d=0;d<c;d++){var p;p=a.categories[d].eventListeners.single;if(a.id&&(g=p[a.id])||(g=p[a.url])||(g=p[a.fullUrl]))for(p=0;p<g.length;p++){var s=g[p];s.async?setTimeout(e(s,this,a),0):s.call(this,a)}}for(d=0;d<c;d++)a.categories[d].checkForAllLoaded()};i.prototype.addEventListener=function(a,b,d){if(!b||Object.prototype.toString.call(b)!==
"[object Function]")return this;b.runAsync=d||!1;if(a==="*")this.eventListeners.push(b);else{typeof a==="string"&&(a=a.split(":"));var c=a[0],c=this.categories[c]||(this.categories[c]=new i.Category(c,this)),e=a.length>1?a[1]:!1;if(e){var g,p;if(!(g=c.resourcesById[e]))for(a=c.resources.length-1;a>=0;a--)if(p=c.resources[a],p!==k&&p.fullUrl===e){g=p;break}g&&g.loaded?d?setTimeout(function(){b.call(this,g)},0):b.call(this,g):(c.eventListeners.single[e]||(c.eventListeners.single[e]=[])).push(b)}else c.eventListeners.load.push(b),
c.checkForAllLoaded()}return this};var d=function(){var a=f.LDR8R;if(a){var b;for(b=0;b<a.length;b++)a[b]()}};d.prototype.push=function(a){if(Object.prototype.toString.call(a)==="[object Function]"){var b=Array.prototype.slice.call(arguments,1);a.apply(null,b)}};a=new i;f.LDR8R=new d})(window);(function(f,k){if(k.addEventListener){var i=Array.prototype,a=Object.prototype,b=i.forEach,g=i.slice,e=a.hasOwnProperty,l=a.toString,d=/^(#([\w\-\_\.]+))$/,r=[],q=!1,o=function(){return f.requestAnimationFrame||f.webkitRequestAnimationFrame||f.mozRequestAnimationFrame||f.oRequestAnimationFrame||f.msRequestAnimationFrame||function(a){f.setTimeout(a,16)}}(),c=function(a,b){return new c.p.init(a,b||null)};c.instances=[];c.instanceIds={};c.removeInstance=function(a){if(c.instances.length)return c.instances.splice(c.instanceIds[a.id],
1),delete c.instanceIds[a.id],c.instances};c.addInstance=function(a){var b=c.instances.length,d=a.media.id&&a.media.id;a.id=!(d in c.instanceIds)&&d||"__popcorn"+b;c.instanceIds[a.id]=b;c.instances.push(a);return c.instances};c.getInstanceById=function(a){return c.instances[c.instanceIds[a]]};c.removeInstanceById=function(a){return c.removeInstance(c.instances[c.instanceIds[a]])};c.p=c.prototype={init:function(a,b){var m;if(typeof a==="function")if(k.readyState==="interactive"||k.readyState==="complete")a(k,
c);else{if(r.push(a),!q){q=!0;var j=function(){k.removeEventListener("DOMContentLoaded",j,!1);for(var a=0,b=r.length;a<b;a++)r[a].call(k,c);r=null};k.addEventListener("DOMContentLoaded",j,!1)}}else{this.media=(m=d.exec(a))&&m.length&&m[2]?k.getElementById(m[2]):a;this[this.media.nodeName&&this.media.nodeName.toLowerCase()||"video"]=this.media;c.addInstance(this);this.options=b||{};this.data={disabled:[],events:{},history:[],trackEvents:{byStart:[{start:-1,end:-1}],byEnd:[{start:-1,end:-1}],animating:[],
startIndex:0,endIndex:0,previousUpdateTime:-1},loading:[],loadingListener:!1};var e=function(a){if(a.media.readyState>=2){var b=a.media.duration,b=b!=b?Number.MAX_VALUE:b+1;c.addTrackEvent(a,{start:b,end:b});a.media.addEventListener("timeupdate",function(c){a.data.timeupdateEvent=c},!1);var p=function(){var b=a.media.currentTime,d=a.data.trackEvents.previousUpdateTime,j=a.data.trackEvents,e=j.byEnd,h=j.byStart,m=j.animating,g=a.data.timeupdateEvent,s=0;if(d<b){for(;e[j.endIndex]&&e[j.endIndex].end<=
b;)if(!e[j.endIndex]._natives||a[e[j.endIndex]._natives.type]){if(e[j.endIndex]._running===!0)e[j.endIndex]._running=!1,e[j.endIndex]._natives.end.call(a,g,e[j.endIndex]);j.endIndex++}else{c.removeTrackEvent(a,e[j.endIndex]._id);return}for(;h[j.startIndex]&&h[j.startIndex].start<=b;)if(!h[j.startIndex]._natives||a[h[j.startIndex]._natives.type]){if(h[j.startIndex].end>b&&h[j.startIndex]._running===!1&&a.data.disabled.indexOf(h[j.startIndex]._natives.type)===-1)h[j.startIndex]._running=!0,h[j.startIndex]._natives.start.call(a,
g,h[j.startIndex]),h[j.startIndex]._natives.frame&&m.push(h[j.startIndex]);j.startIndex++}else{c.removeTrackEvent(a,h[j.startIndex]._id);return}for(;s<m.length;)m[s]._running==!1?m.splice(s,1):(m[s]._natives.frame.call(a,g,m[s],b),s++)}else if(d>b){for(;h[j.startIndex]&&h[j.startIndex].start>b;)if(!h[j.startIndex]._natives||a[h[j.startIndex]._natives.type]){if(h[j.startIndex]._running===!0)h[j.startIndex]._running=!1,h[j.startIndex]._natives.end.call(a,g,h[j.startIndex]);j.startIndex--}else{c.removeTrackEvent(a,
h[j.startIndex]._id);return}for(;e[j.endIndex]&&e[j.endIndex].end>b;)if(!e[j.endIndex]._natives||a[e[j.endIndex]._natives.type]){if(e[j.endIndex].start<=b&&e[j.endIndex]._running===!1&&a.data.disabled.indexOf(h[j.endIndex]._natives.type)===-1)e[j.endIndex]._running=!0,e[j.endIndex]._natives.start.call(a,g,e[j.endIndex]),e[j.endIndex]._natives.frame&&m.push(e[j.endIndex]);j.endIndex--}else{c.removeTrackEvent(a,e[j.endIndex]._id);return}for(;s<m.length;)m[s]._running==!1?m.splice(s,1):(m[s]._natives.frame.call(a,
g,m[s],b),s++)}j.previousUpdateTime=b;o(p)};o(p)}else f.setTimeout(function(){e(a)},1)};e(this);return this}}};c.p.init.prototype=c.p;c.forEach=function(a,c,d){if(!a||!c)return{};d=d||this;if(b&&a.forEach===b)return a.forEach(c,d);for(var j in a)e.call(a,j)&&c.call(d,a[j],j,a);return a};c.extend=function(a){var b=a,d=g.call(arguments,1);c.forEach(d,function(a){for(var c in a)b[c]=a[c]});return b};c.extend(c,{error:function(a){throw Error(a);},guid:function(a){c.guid.counter++;return(a?a:"")+(+new Date+
c.guid.counter)},sizeOf:function(a){var c=0,b;for(b in a)c++;return c},isArray:Array.isArray||function(a){return l.call(a)==="[object Array]"},nop:function(){},position:function(a){var a=a.getBoundingClientRect(),b={},d=k.documentElement,j=k.body,e,g,i;e=d.clientTop||j.clientTop||0;g=d.clientLeft||j.clientLeft||0;i=f.pageYOffset&&d.scrollTop||j.scrollTop;d=f.pageXOffset&&d.scrollLeft||j.scrollLeft;e=Math.ceil(a.top+i-e);g=Math.ceil(a.left+d-g);for(var C in a)b[C]=Math.round(a[C]);return c.extend({},
b,{top:e,left:g})},disable:function(a,c){var b=a.data.disabled;b.indexOf(c)===-1&&b.push(c);return a},enable:function(a,c){var b=a.data.disabled,d=b.indexOf(c);d>-1&&b.splice(d,1);return a}});c.guid.counter=1;c.extend(c.p,function(){var a={};c.forEach("load play pause currentTime playbackRate mute volume duration paused".split(/\s+/g),function(c){a[c]=function(a){if(typeof this.media[c]==="function")return this.media[c](),this;return a!==!1&&a!==null&&typeof a!=="undefined"?(this.media[c]=a,this):
this.media[c]}});return a}());c.forEach("enable disable".split(" "),function(a){c.p[a]=function(b){return c[a](this,b)}});c.extend(c.p,{roundTime:function(){return-~this.media.currentTime},exec:function(a,b){c.addTrackEvent(this,{start:a,end:a+1,_running:!1,_natives:{start:b||c.nop,end:c.nop,type:"exec"}});return this},position:function(){return c.position(this.media)},toggle:function(a){return c[this.data.disabled.indexOf(a)>-1?"enable":"disable"](this,a)}});c.Events={UIEvents:"blur focus focusin focusout load resize scroll unload  ",
MouseEvents:"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave click dblclick",Events:"loadstart progress suspend emptied stalled play pause loadedmetadata loadeddata waiting playing canplay canplaythrough seeking seeked timeupdate ended ratechange durationchange volumechange"};c.Events.Natives=c.Events.UIEvents+" "+c.Events.MouseEvents+" "+c.Events.Events;c.events={isNative:function(a){for(var b=c.Events.Natives.split(/\s+/g),d=0;d<b.length;d++)if(b[d]===a)return!0;return!1},getInterface:function(a){if(!c.events.isNative(a))return!1;
var b=c.Events,d,j;for(j in b)j!=="Natives"&&b[j].indexOf(a)>-1&&(d=j);return d},all:c.Events.Natives.split(/\s+/g),fn:{trigger:function(a,b){if(this.data.events[a]&&c.sizeOf(this.data.events[a])){var d=c.events.getInterface(a);if(d)return d=k.createEvent(d),d.initEvent(a,!0,!0,f,1),this.media.dispatchEvent(d),this;c.forEach(this.data.events[a],function(a){a.call(this,b)},this)}return this},listen:function(a,b){var d=this,j=!0;this.data.events[a]||(this.data.events[a]={},j=!1);this.data.events[a][b.name||
b.toString()+c.guid()]=b;!j&&c.events.all.indexOf(a)>-1&&this.media.addEventListener(a,function(b){c.forEach(d.data.events[a],function(a){typeof a==="function"&&a.call(d,b)})},!1);return this},unlisten:function(a,c){if(this.data.events[a]&&this.data.events[a][c])return delete this.data.events[a][c],this;this.data.events[a]=null;return this}}};c.forEach(["trigger","listen","unlisten"],function(a){c.p[a]=c.events.fn[a]});c.protect={natives:"load play pause currenttime playbackrate mute volume duration removeplugin roundtime trigger listen unlisten".split(/\s+/)};
c.addTrackEvent=function(a,b){if(b._natives)b._id=!b.id?c.guid(b._natives.type):b.id,a.data.history.push(b._id),b._natives.start=b._natives.start||c.nop,b._natives.end=b._natives.end||c.nop;b.start=c.util.toSeconds(b.start,a.options.framerate);b.end=c.util.toSeconds(b.end,a.options.framerate);var d=a.data.trackEvents.byStart,j=a.data.trackEvents.byEnd,e;for(e=d.length-1;e>=0;e--)if(b.start>=d[e].start){d.splice(e+1,0,b);break}for(e=j.length-1;e>=0;e--)if(b.start>=j[e].start){j.splice(e+1,0,b);break}};
c.removePlugin=function(a,b){if(!b){var b=a,a=c.p,d=c.registry.length,j;for(j=0;j<d;j++)if(c.registry[j].name===b){c.registry.splice(j,1);delete c.registryByName[b];delete a[b];return}}d=a.data.trackEvents.byStart;j=a.data.trackEvents.byEnd;var e,g;for(e=0,g=d.length;e<g;e++)d[e]&&d[e]._natives&&d[e]._natives.type===b&&j[e]&&j[e]._natives&&j[e]._natives.type===b&&(d.splice(e,1),j.splice(e,1),e--,g--,a.data.trackEvents.startIndex<=e&&(a.data.trackEvents.startIndex--,a.data.trackEvents.endIndex--))};
c.removeTrackEvent=function(a,b){var d=a.data.history.length,j=0,e=[],g=[],i=[];c.forEach(a.data.trackEvents.byStart,function(c,d){c._id||(e.push(a.data.trackEvents.byStart[d]),g.push(a.data.trackEvents.byEnd[d]));c._id&&(c._id!==b&&(e.push(a.data.trackEvents.byStart[d]),g.push(a.data.trackEvents.byEnd[d])),c._id===b&&(j=d,c._natives._teardown&&c._natives._teardown.call(a,c)))});j<=a.data.trackEvents.startIndex&&a.data.trackEvents.startIndex--;j<=a.data.trackEvents.endIndex&&a.data.trackEvents.endIndex--;
a.data.trackEvents.byStart=e;a.data.trackEvents.byEnd=g;for(var f=0;f<d;f++)a.data.history[f]!==b&&i.push(a.data.history[f]);a.data.history=i};c.getTrackEvents=function(a){var b=[];c.forEach(a.data.trackEvents.byStart,function(a){a._id&&b.push(a)});return b};c.getLastTrackEventId=function(a){return a.data.history[a.data.history.length-1]};c.extend(c.p,{getTrackEvents:function(){return c.getTrackEvents.call(null,this)},getLastTrackEventId:function(){return c.getLastTrackEventId.call(null,this)},removeTrackEvent:function(a){c.removeTrackEvent.call(null,
this,a);return this},removePlugin:function(a){c.removePlugin.call(null,this,a);return this}});c.manifest={};c.registry=[];c.registryByName={};c.plugin=function(a,b,d){if(c.protect.natives.indexOf(a.toLowerCase())>=0)c.error("'"+a+"' is a protected function name");else{var j=["start","end"],e={},g=typeof b==="function";d||(d=b.manifest||{});var i=function(b,e){if(!e)return this;e._natives=b;e._natives.type=a;e._running=!1;e._natives.manifest=d;if(!("start"in e))e.start=0;if(!("end"in e))e.end=this.duration();
if("_setup"in b&&typeof b._setup==="function"){if(!e.target){var g="options"in d&&d.options;e.target=g&&"target"in g&&g.target}b._setup.call(this,e)}c.addTrackEvent(this,e);c.forEach(b,function(a,b){b!=="type"&&j.indexOf(b)===-1&&this.listen(b,a)},this);return this};if(d||"manifest"in b)c.manifest[a]=d||b.manifest;e[a]=function(a){return i.call(this,g?b.call(this,a):b,a)};c.extend(c.p,e);var f={fn:e[a],definition:b,base:b,parents:[],name:a};c.registry.push(c.extend(e,f,{type:a}));c.registryByName[a]=
f;return e}};c.plugin.getDefinition=function(a){var b=c.registryByName;if(b[a])return b[a];c.error("Cannot inherit from "+a+"; Object does not exist")};c.plugin.delegate=function(a,b,c){return function(){var d=arguments;c.forEach(function(c){c[b]&&c[b].apply(a,d)})}};c.plugin.inherit=function(a,b,d,j){function g(a,b){var d=b||c.plugin.getDefinition(a).parents,j;for(j in d)if(e.call(d,j)){var m=d[j];g(m);i.indexOf(m)===-1&&i.push(m)}}var i=[];g(a,c.isArray(b)?b:[b]);i.push(a);j=c.plugin(a,function(a){var b=
this,d;d=i.map(function(d){d=c.plugin.getDefinition(d).base;return d.call&&d.call(b,a)||d});return{_setup:c.plugin.delegate(b,"_setup",d),start:c.plugin.delegate(b,"start",d),end:c.plugin.delegate(b,"end",d)}},j||d.manifest);a=c.plugin.getDefinition(a);a.base=d;a.parents=b;return j};c.inherit=c.plugin.inherit;c.parsers={};c.parser=function(a,b,d){if(c.protect.natives.indexOf(a.toLowerCase())>=0)c.error("'"+a+"' is a protected function name");else if(typeof b==="function"&&!d&&(d=b,b=""),!(typeof d!==
"function"||typeof b!=="string")){var j={};j[a]=function(a,j){if(!a)return this;var g=this;c.xhr({url:a,dataType:b,success:function(a){var b,c,i=0,a=d(a).data||[];if(b=a.length){for(;i<b;i++){c=a[i];for(var f in c)if(e.call(c,f)&&g[f])g[f](c[f])}j&&j()}}});return this};c.extend(c.p,j);return j}};var t=/\?/,u={url:"",data:"",dataType:"",success:c.nop,type:"GET",async:!0,xhr:function(){return new f.XMLHttpRequest}};c.xhr=function(a){a.dataType=a.dataType&&a.dataType.toLowerCase()||null;if(a.dataType&&
(a.dataType==="jsonp"||a.dataType==="script"))c.xhr.getJSONP(a.url,a.success,a.dataType==="script");else if(a=c.extend({},u,a),a.ajax=a.xhr(),a.ajax){if(a.type==="GET"&&a.data)a.url+=(t.test(a.url)?"&":"?")+a.data,a.data=null;a.ajax.open(a.type,a.url,a.async);a.ajax.send(a.data||null);return c.xhr.httpData(a)}};c.xhr.httpData=function(a){var b,c=null;a.ajax.onreadystatechange=function(){if(a.ajax.readyState===4){try{c=JSON.parse(a.ajax.responseText)}catch(d){}b={xml:a.ajax.responseXML,text:a.ajax.responseText,
json:c};a.dataType&&(b=b[a.dataType]);a.success.call(a.ajax,b)}};return b};c.xhr.getJSONP=function(a,b,d){if(d&&k.querySelectorAll('script[src="'+a+'"]').length)b&&b(!0);else{var e=k.head||k.getElementsByTagName("head")[0]||k.documentElement,g=k.createElement("script"),i=a.split("?")[1],f=!1,l=[],o,r;i&&!d&&(l=i.split("&"));l.length&&(r=l[l.length-1].split("="));o=l.length?r[1]?r[1]:r[0]:"jsonp";!i&&!d&&(a+="?callback="+o);o&&!d&&(window[o]&&(o=c.guid(o)),window[o]=function(a){b&&b(a);f=!0},a=a.replace(r.join("="),
r[0]+"="+o));g.onload=g.onreadystatechange=function(){if(!g.readyState||/loaded|complete/.test(g.readyState))d&&b&&b(),f&&(delete window[o],e.removeChild(g))};g.src=a;e.insertBefore(g,e.firstChild)}};c.getJSONP=c.xhr.getJSONP;c.getScript=c.xhr.getScript=function(a,b){return c.xhr.getJSONP(a,b,!0)};c.util={toSeconds:function(a,b){var d=/^([0-9]+:){0,2}[0-9]+([.;][0-9]+)?$/;if(typeof a==="number")return a;else typeof a==="string"?d.test(a)||c.error("Invalid time format"):c.error("Invalid time format");
var d=a.split(":"),e=d.length-1,g=d[e];if(g.indexOf(";")>-1){var g=g.split(";"),i=0;b&&typeof b==="number"&&(i=parseFloat(g[1],10)/b);d[e]=parseInt(g[0],10)+i}if(d.length===1)return parseFloat(d[0],10);else if(d.length===2)return parseInt(d[0],10)*60+parseFloat(d[1],10);else if(d.length===3)return parseInt(d[0],10)*3600+parseInt(d[1],10)*60+parseFloat(d[2],10)}};f.Popcorn=c;k.addEventListener("DOMContentLoaded",function(){var a=k.querySelectorAll("[data-timeline-sources]");c.forEach(a,function(b,
d){var e=a[d],g,i,f;if(!e.id)e.id=c.guid("__popcorn");e.nodeType&&e.nodeType===1&&(f=c("#"+e.id),g=(e.getAttribute("data-timeline-sources")||"").split(","),g[0]&&c.forEach(g,function(a){i=a.split("!");i.length===1&&(i=a.split("."),i[0]="parse"+i[i.length-1].toUpperCase(),i[1]=a);if(g[0]&&f[i[0]])f[i[0]](i[1])}),f.autoplay&&f.play())})},!1)}})(window,window.document);(function(f){f&&f.plugin("code",function(f){if(!f.onStart||typeof f.onStart!=="function")throw"Popcorn Code Plugin Error: onStart must be a function.";if(f.onEnd&&typeof f.onEnd!=="function")throw"Popcorn Code Plugin Error: onEnd  must be a function.";if(f.onFrame&&typeof f.onFrame!=="function")throw"Popcorn Code Plugin Error: onFrame  must be a function.";return{start:function(i,a){a.onStart(a)},end:function(i,a){if(a.onEnd)a.onEnd(a)},frame:f.onFrame}},{about:{name:"Popcorn Code Plugin",version:"0.1",
author:"David Humphrey (@humphd)",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},onStart:{elem:"input",type:"function",label:"onStart"},onFrame:{elem:"input",type:"function",label:"onFrame"},onEnd:{elem:"input",type:"function",label:"onEnd"}}})})(window.Popcorn);(function(f){function k(a){if(!a)return!1;if(a.which)return a.which===3;if(a.button)return a.button===2}if(f){var i=0;f.plugin("europeana",function(a){var b,g,e,f,d,r,q=this,o=!1,c,t,u,p;if(!a||!a.id)return{_setup:function(){}};p=function(a){(a.keyCode||a.which)===27&&u()};c=function(a){if(!k(a)){var c=a.target;do if(c===b)return!0;while(c=c.parentNode);console.log(a);u();return!1}};t=function(a){if(!k(a)){o=q.media.paused;q.pause();g.removeEventListener("click",t,!1);window.addEventListener("click",
c,!0);window.addEventListener("keydown",p,!0);b.classList.add("active");b.style.cssText="";if(f&&16/9*0.4*e.height/e.width>0.8)b.style.width=e.width/e.height*7.2/16*100+"%";if(a)a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.returnValue=!1,a.cancelBubble=!0;return!1}};u=function(a){if(!k(a)){b.classList.remove("active");b.style.width=f;if(d||r)b.style.top=d,b.style.left=r,b.style.position="absolute";g.addEventListener("click",t,!1);window.removeEventListener("keydown",
p,!0);window.removeEventListener("click",c,!0);o||q.play();if(a)a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.returnValue=!1,a.cancelBubble=!0;return!1}};a.loaded=!1;b=document.createElement("div");b.setAttribute("class","europeana");b.id="europeana"+i;if(a.width)b.style.width=a.width;if(a.height)b.style.height=a.height;b.style.display="none";i++;if(document.getElementById(a.target))document.getElementById(a.target).appendChild(b);else throw"europeana target container doesn't exist";
if(a.top||a.left)b.style.position="absolute",b.style.top=a.top,b.style.left=a.left;g=document.createElement("div");g.style.position="relative";b.appendChild(g);var s=new XMLHttpRequest;s.open("GET","europeana.php?id="+a.id);s.onreadystatechange=function(){function b(a){return o[a]||null}function c(a,d){var e,h;e=d.ownerDocument||d;if(e.evaluate)return(e=e.evaluate(a,d,b,XPathResult.FIRST_ORDERED_NODE_TYPE,null))&&e.singleNodeValue;else{e.setProperty("SelectionLanguage","XPath");if(!m){m=[];for(h in o)m.push("xmlns:"+
h+'="'+o[h]+'"');m=m.join(" ");e.setProperty("SelectionNamespaces",m)}if(d===e&&e.documentElement)d=e.documentElement;return d.selectSingleNode(a)}}function i(a,b){var c,d=[],e=b-3;if(!a)return"";if(a.length<=b)return a;a=a.split(" ");if(a[0].length>b)return a[0].substr(0,b-3)+"...";for(c=0;c<a.length;c++){if(a[c].length<=e)d.push(a[c]);else return d.join(" ")+"...";e-=d[c].length+1}return d.join(" ")}var m="",o={srw:"http://www.loc.gov/zing/srw/",diag:"http://www.loc.gov/zing/srw/diagnostic/",xcql:"http://www.loc.gov/zing/cql/xcql/",
mods:"http://www.loc.gov/mods/v3",europeana:"http://www.europeana.eu",enrichment:"http://www.europeana.eu/schemas/ese/enrichment/",dcterms:"http://purl.org/dc/terms/",dc:"http://purl.org/dc/elements/1.1/",dcx:"http://purl.org/dc/elements/1.1/",tel:"http://krait.kb.nl/coop/tel/handbook/telterms.html",xsi:"http://www.w3.org/2001/XMLSchema-instance"};if(s.readyState===4&&s.status===200){var k=s.responseXML;if(k){var q=!k.ownerDocument?k.documentElement:k.ownerDocument.documentElement;(k=c("//dc:title",
q))?(k=k.firstChild.nodeValue||"",k=i(k,32)):k="";var p=c("//dc:description",q),p=p?p.firstChild.nodeValue||"":"",v=c("//dc:source",q);v?(v=v.firstChild.nodeValue||"",v=i(v,50)):(v=c("//europeana:provider",q))?(v=v.firstChild.nodeValue||"",v=i(v,50)):v="";v&&(v="/"+v);var q=(q=c("//europeana:object",q))?q.firstChild.nodeValue||"":"",h=document.createElement("div");h.setAttribute("class","content");var Y=document.createElement("article");Y.appendChild(document.createTextNode(p));h.appendChild(Y);h.appendChild(document.createElement("br"));
g.appendChild(h);p=document.createElement("div");p.setAttribute("class","info");k=k.replace("<","&lt;");k=k.replace(">","&gt;");p.innerHTML='<div class="media"><span class="hiding minimize" style="float: right; margin-right: 20px;">minimize window</span>image<span class="hiding"> | <span class="popcorn-source">source</span>: <a href="http://www.europeana.eu/portal/record/'+a.id+'.html" target="_new">Europeana'+v+'</a></span></div><div><a href="http://www.europeana.eu/portal/record/'+a.id+'.html" target="_new">'+
k+'</a></div><div class="watch">view details</div>';p.getElementsByClassName("minimize").item(0).addEventListener("click",u,!1);g.appendChild(p);q?(e=document.createElement("img"),e.src=q,e.onload=function(){a.loaded=!0},h.insertBefore(e,h.firstChild)):a.loaded=!0;f=a.width;d=a.top;r=a.left;g.addEventListener("click",t,!1)}}};s.send(null);var m=a.end-a.start;if(isNaN(a.fadeIn))a.fadeIn=Math.min(0.25,m/8);else if(a.fadeIn>m)a.fadeIn=m;m-=a.fadeIn;if(isNaN(a.fadeOut))a.fadeOut=Math.min(0.25,(a.end-
a.start)/8);else if(a.fadeOut>m)a.fadeIn=m;return{start:function(a,c){var d=function(){c.loaded||e.loaded?b.style.display="":setTimeout(d,1)};d()},end:function(){b.style.display="none"},_teardown:function(a){(a=document.getElementById(a.target))&&a.removeChild(b)},frame:function(a,c,d){var a=d-c.start,e=1;a<c.fadeIn?e=a/c.fadeIn:d>c.end-c.fadeOut&&(e=(c.end-d)/c.fadeOut);b.style.opacity=e}}},{about:{name:"Popcorn Flickr Plugin",version:"0.2",author:"Scott Downe, Steven Weerdenburg, Annasob",website:"http://scottdowne.wordpress.com/"},
options:{start:{elem:"input",type:"number",label:"In"},end:{elem:"input",type:"number",label:"Out"},userid:{elem:"input",type:"text",label:"UserID"},tags:{elem:"input",type:"text",label:"Tags"},username:{elem:"input",type:"text",label:"Username"},apikey:{elem:"input",type:"text",label:"Api_key"},target:"flickr-container",height:{elem:"input",type:"text",label:"Height"},width:{elem:"input",type:"text",label:"Width"},padding:{elem:"input",type:"text",label:"Padding"},border:{elem:"input",type:"text",
label:"Border"},numberofimages:{elem:"input",type:"text",label:"Number of Images"}}})}})(window.Popcorn);(function(f){function k(a){if(!a)return!1;if(a.which)return a.which===3;if(a.button)return a.button===2}if(f){var i=0;f.plugin("flickr",function(a){var b,g,e,l,d,r,q=a.numberofimages||4,o,c,t,u,p=a.padding||"5px",s=a.border||"0px",m=this,j=!1,x,B,z,C;C=function(a){(a.keyCode||a.which)===27&&z()};x=function(a){if(!k(a)){a=a.target;do if(a===b)return!0;while(a=a.parentNode);z();return!1}};B=function(a){if(!k(a)){j=m.media.paused;m.pause();g.removeEventListener("click",B,!1);window.addEventListener("click",
x,!0);window.addEventListener("keydown",C,!0);b.classList.add("active");b.style.cssText="";if(a)a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.returnValue=!1,a.cancelBubble=!0;return!1}};z=function(a){if(!k(a)){b.classList.remove("active");b.style.width=c;if(t||u)b.style.top=t,b.style.left=u,b.style.position="absolute";g.addEventListener("click",B,!1);window.removeEventListener("keydown",C,!0);window.removeEventListener("click",x,!0);j||m.play();if(a)a.preventDefault&&
a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.returnValue=!1,a.cancelBubble=!0;return!1}};a.loaded=!1;b=document.createElement("div");b.setAttribute("class","flickr");b.id="flickr"+i;if(a.width)b.style.width=a.width;if(a.height)b.style.height=a.height;b.style.display="none";i++;if(document.getElementById(a.target))document.getElementById(a.target).appendChild(b);else throw"flickr target container doesn't exist";if(a.top||a.left)b.style.position="absolute",b.style.top=a.top,b.style.left=
a.left;g=document.createElement("div");g.style.position="relative";b.appendChild(g);var K=function(){l="http://api.flickr.com/services/feeds/photos_public.gne?";e&&(l+="id="+e+"&");a.tags&&(l+="tags="+a.tags+"&");l+="lang=en-us&format=json&jsoncallback=flickr";f.xhr.getJSONP(l,function(b){g.innerHTML="<p style='padding:"+p+";'>"+b.title+"<p/>";f.forEach(b.items,function(b,e){if(e<q)d=document.createElement("a"),d.setAttribute("href",b.link),d.setAttribute("target","_blank"),r=document.createElement("img"),
r.setAttribute("src",b.media.m),r.setAttribute("height",o),r.setAttribute("width",c),r.setAttribute("style","border:"+s+";padding:"+p),d.appendChild(r),g.appendChild(d),a.loaded=!0;else return!1})})},M=function(){e?setTimeout(function(){M()},5):(l="http://api.flickr.com/services/rest/?method=flickr.people.findByUsername&",l+="username="+a.username+"&api_key="+a.apikey+"&format=json&jsoncallback=flickr",f.getJSONP(l,function(a){e=a.user.nsid;K()}))},G=function(){if(m.media&&m.media.buffered&&m.media.buffered.length){var b,
d,e=!1,j,i,k=m.media.buffered;for(b=0,d=k.length;b<d;b++)if(j=k.start(b),i=k.end(b),j>m.media.duration&&(j=0),j<=a.end&&i>=a.start){e=!0;break}if(!e){setTimeout(G,10);return}}l="http://api.flickr.com/services/rest/?method=flickr.photos.getInfo";a.apikey&&(l+="&api_key="+a.apikey);l+="&photo_id="+a.photoid+"&lang=en-us&format=json&jsoncallback=flickr";f.xhr.getJSONP(l,function(b){if(b&&b.stat==="ok"&&b.photo){var b=b.photo,d=document.createElement("img");d.src="http://farm"+b.farm+".static.flickr.com/"+
b.server+"/"+b.id+"_"+b.secret+"_m.jpg";d.style.width="100%";var e=a.url;e||(e=b.urls&&b.urls.url&&b.urls.url[0]&&b.urls.url[0]._content?b.urls.url[0]._content:"http://www.flickr.com/photos/"+b.owner.nsid+"/"+b.id+"/");g.appendChild(d);var h=document.createElement("div");h.setAttribute("class","info");h.innerHTML='<div class="media"><span class="hiding minimize" style="float: right; margin-right: 20px;">minimize window</span>photo<span class="hiding"> | <span class="popcorn-source">source</span>: <a href="'+
e+'" target="_new">Flickr</a></span></div><div><a href="'+e+'" target="_new">'+b.title._content+'</a></div><div class="watch">view photo</div>';h.getElementsByClassName("minimize").item(0).addEventListener("click",z,!1);g.appendChild(h);c=a.width;t=a.top;u=a.left;d.addEventListener("load",function(){var b=/(\d*(\.\d*)?)\s*(px|em|\%|em|rem)?/,c,e,h;e=d.width||d.naturalWidth;h=d.height||d.naturalHeight;if(a.width&&!a.height&&(c=b.exec(a.width))&&c.length>1)if(b=c[3]||"",c=parseFloat(c[1]),g.style.height=
o=c*h/e+b,!d.width)d.style.height=100*h/e+"%";a.loaded=!0},!1);g.addEventListener("click",B,!1)}})};if(a.url&&!a.photoid){var v=/^((https?:\/\/)?(www\.)?flickr\.com\/photos\/[^\/]+\/)?(\d+)/.exec(a.url);if(v&&v.length>=5)a.photoid=v[4]}a.photoid?G():a.username&&a.apikey?M():(e=a.userid,K());v=a.end-a.start;if(isNaN(a.fadeIn))a.fadeIn=Math.min(0.25,v/8);else if(a.fadeIn>v)a.fadeIn=v;v-=a.fadeIn;if(isNaN(a.fadeOut))a.fadeOut=Math.min(0.25,(a.end-a.start)/8);else if(a.fadeOut>v)a.fadeIn=v;return{start:function(a,
c){var d=function(){c.loaded?b.style.display="":setTimeout(d,1)};d()},end:function(){b.style.display="none"},_teardown:function(a){(a=document.getElementById(a.target))&&a.removeChild(b)},frame:function(a,c,d){var a=d-c.start,e=1;a<c.fadeIn?e=a/c.fadeIn:d>c.end-c.fadeOut&&(e=(c.end-d)/c.fadeOut);b.style.opacity=e}}},{about:{name:"Popcorn Flickr Plugin",version:"0.2",author:"Scott Downe, Steven Weerdenburg, Annasob",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"number",
label:"In"},end:{elem:"input",type:"number",label:"Out"},userid:{elem:"input",type:"text",label:"UserID"},tags:{elem:"input",type:"text",label:"Tags"},username:{elem:"input",type:"text",label:"Username"},apikey:{elem:"input",type:"text",label:"Api_key"},target:"flickr-container",height:{elem:"input",type:"text",label:"Height"},width:{elem:"input",type:"text",label:"Width"},padding:{elem:"input",type:"text",label:"Padding"},border:{elem:"input",type:"text",label:"Border"},numberofimages:{elem:"input",
type:"text",label:"Number of Images"}}})}})(window.Popcorn);var googleCallback;
(function(f){function k(a){if(!a)return!1;if(a.which)return a.which===3;if(a.button)return a.button===2}if(f){var i=0,a=0,b=!1,g=!1,e,l;googleCallback=function(a){typeof window.google!=="undefined"&&window.google.maps&&window.google.maps.Geocoder&&window.google.maps.LatLng?(e=new window.google.maps.Geocoder,g=!0):setTimeout(function(){googleCallback(a)},1)};l=function(){document.body?(b=!0,f.getScript("http://maps.google.com/maps/api/js?sensor=false&callback=googleCallback")):setTimeout(function(){l()},1)};
f.plugin("googlemap",function(d){var f,q,o,c,t=!1,u=this,p,s=!1,m,j,x,B,z,C,K;b||l();d.map=null;B=function(a){(a.keyCode||a.which)===27&&x()};m=function(a){if(k(a))return!0;var b=a.target;do if(b===o)return!0;while(b=b.parentNode);console.log("otherwindows",a);x();return!1};j=function(a){if(k(a))return!0;s=u.media.paused;u.pause();t||p();if(d.map)d.map.getDiv().style.display="block";c.removeEventListener("click",j,!1);window.addEventListener("click",m,!0);window.addEventListener("keydown",B,!0);o.classList.add("active");
o.style.cssText="";if(a)a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.returnValue=!1,a.cancelBubble=!0;return!1};x=function(a){if(k(a))return!0;if(d.map)d.map.getDiv().style.display="none";o.classList.remove("active");o.style.width=z;if(C||K)o.style.top=C,o.style.left=K,o.style.position="absolute";c.addEventListener("click",j,!1);window.removeEventListener("keydown",B,!0);window.removeEventListener("click",m,!0);s||u.play();if(a)a.preventDefault&&a.preventDefault(),
a.stopPropagation&&a.stopPropagation(),a.returnValue=!1,a.cancelBubble=!0;return!1};d.loaded=!1;o=document.createElement("div");o.setAttribute("class","googlemap");o.id="googlemap"+i;if(d.width)o.style.width=d.width;if(d.height)o.style.height=d.height;o.style.display="none";i++;if(document.getElementById(d.target))document.getElementById(d.target).appendChild(o);else throw"googlemap target container doesn't exist";if(d.top||d.left)o.style.position="absolute",o.style.top=d.top,o.style.left=d.left;
c=document.createElement("div");c.style.position="relative";o.appendChild(c);var M=function(){if(u.media&&u.media.buffered&&u.media.buffered.length){var a,b,e=!1,g,i,k=u.media.buffered;for(a=0,b=k.length;a<b;a++)if(g=k.start(a),i=k.end(a),g>u.media.duration&&(g=0),g<=d.end&&i>=d.start){e=!0;break}if(!e){setTimeout(M,10);return}}a="http://maps.googleapis.com/maps/api/staticmap?sensor=false&size=320x320&maptype=roadmap&"+[["center",d.center||d.location],["markers",d.location],["visible",d.location+
"|"+d.center]].map(function(a){return a[0]+"="+encodeURIComponent(a[1])}).join("&");var m=document.createElement("img");m.src=a;m.style.width="100%";c.appendChild(m);c.appendChild(f);b=document.createElement("div");b.setAttribute("class","info");b.innerHTML='<div class="media"><span class="hiding minimize" style="float: right; margin-right: 20px;">minimize window</span>map<span class="hiding"> | <span class="popcorn-source">source</span>: <a href="'+a+'" target="_new">Google Maps</a></span></div><div><a href="'+
a+'" target="_new">'+d.location+'</a></div><div class="watch">view map</div>';b.getElementsByClassName("minimize").item(0).addEventListener("click",x,!1);c.appendChild(b);z=d.width;C=d.top;K=d.left;m.addEventListener("load",function(){var a=/(\d*(\.\d*)?)\s*(px|em|\%|em|rem)?/,b;if(d.width&&!d.height&&(b=a.exec(d.width))&&b.length>1)a=b[3]||"",b=parseFloat(b[1]),b=b*m.height/m.width,c.style.height=b+a;d.loaded=!0},!1);c.addEventListener("click",j,!1)},G=d.end-d.start;if(isNaN(d.fadeIn))d.fadeIn=Math.min(0.25,
G/8);else if(d.fadeIn>G)d.fadeIn=G;G-=d.fadeIn;if(isNaN(d.fadeOut))d.fadeOut=Math.min(0.25,(d.end-d.start)/8);else if(d.fadeOut>G)d.fadeIn=G;if(!d.type)d.type="ROADMAP";f=document.createElement("div");f.id="actualmap"+a;f.style.width="100%";f.style.height="100%";f.style.top=0;f.style.left=0;f.style.position="absolute";a++;p=function(){g?d.location?(t=!0,e.geocode({address:d.location},function(a,b){b===google.maps.GeocoderStatus.OK?(d.lat=a[0].geometry.location.lat(),d.lng=a[0].geometry.location.lng(),
q=new google.maps.LatLng(d.lat,d.lng),d.debug="now i have my map",d.map=new google.maps.Map(f,{mapTypeId:google.maps.MapTypeId[d.type]||google.maps.MapTypeId.HYBRID,draggable:!0}),new google.maps.Marker({position:q,map:d.map,title:d.location})):console.log("cannot get google maps data",b)})):(q=new google.maps.LatLng(d.lat,d.lng),d.debug="now i have my damn map",d.map=new google.maps.Map(f,{mapTypeId:google.maps.MapTypeId[d.type]||google.maps.MapTypeId.HYBRID,draggable:!0}),new google.maps.Marker({position:q,
map:d.map,title:d.location})):setTimeout(function(){p()},5)};M();return{start:function(a,b){var c=function(){if(!(u.media.currentTime>=b.end||u.media.currentTime<b.start))b.loaded?o.style.display="":setTimeout(c,1)};c();var d=this,e=function(){if(b.map){b.map.getDiv().style.display="block";google.maps.event.trigger(b.map,"resize");b.map.setCenter(q);if(b.zoom&&typeof b.zoom!=="number")b.zoom=+b.zoom;b.zoom=b.zoom||8;b.map.setZoom(b.zoom);if(b.heading&&typeof b.heading!=="number")b.heading=+b.heading;
if(b.pitch&&typeof b.pitch!=="number")b.pitch=+b.pitch}else d.media.currentTime>=b.start&&d.media.currentTime<=b.end&&setTimeout(function(){e()},13)};e()},end:function(a,b){o.style.display="none";if(b.map)b.map.getDiv().style.display="none"},_teardown:function(a){document.getElementById(a.target).removeChild(o);o=c=f=a.map=q=null},frame:function(a,b,c){var a=c-b.start,d=1;a<b.fadeIn?d=a/b.fadeIn:c>b.end-b.fadeOut&&(d=(b.end-c)/b.fadeOut);o.style.opacity=d}}},{about:{name:"Popcorn Google Map Plugin",
version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"map-container",type:{elem:"select",options:["ROADMAP","SATELLITE","STREETVIEW","HYBRID","TERRAIN"],label:"Type"},zoom:{elem:"input",type:"text",label:"Zoom"},lat:{elem:"input",type:"text",label:"Lat"},lng:{elem:"input",type:"text",label:"Lng"},location:{elem:"input",type:"text",label:"Location"},heading:{elem:"input",type:"text",label:"Heading"},
pitch:{elem:"input",type:"text",label:"Pitch"}}})}})(window.Popcorn);(function(f){f&&f.plugin("html",{manifest:{about:{name:"Popcorn html Plugin",version:"0.1",author:"Brian Chirls",website:"http://chirls.com/"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"html-container",html:{elem:"input",type:"text",label:"Text"},fadeIn:{elem:"input",type:"text",label:"Text"},fadeOut:{elem:"input",type:"text",label:"Text"}}},_setup:function(f){f.container=f.target&&f.target!=="html-container"?document.getElementById(f.target):
this.container;var i=f.end-f.start;if(isNaN(f.fadeIn))f.fadeIn=0;else if(f.fadeIn>i)f.fadeIn=i;i-=f.fadeIn;if(isNaN(f.fadeOut))f.fadeOut=0;else if(f.fadeOut>i)f.fadeIn=i;f.div=document.createElement("div");f.className&&f.div.setAttribute("class",f.className);f.div.style.display="none";f.div.innerHTML=f.html;f.container.appendChild(f.div)},start:function(f,i){i.div.style.display=""},end:function(f,i){i.div.style.display="none"},frame:function(f,i,a){var f=a-i.start,b=1;f<i.fadeIn?b=f/i.fadeIn:a>i.end-
i.fadeOut&&(b=(i.end-a)/i.fadeOut);i.div.style.opacity=b}})})(window.Popcorn);(function(f){function k(a){if(!a)return!1;if(a.which)return a.which===3;if(a.button)return a.button===2}if(f){var i=0;f.plugin("image",function(a){var b,g,e,f,d,r,q=this,o=!1,c,t,u,p;if(a.url){p=function(a){(a.keyCode||a.which)===27&&u()};c=function(a){if(!k(a)){var c=a.target;do if(c===b)return!0;while(c=c.parentNode);console.log(a);u();return!1}};t=function(a){if(!k(a)){o=q.media.paused;q.pause();g.removeEventListener("click",t,!1);window.addEventListener("click",c,!0);window.addEventListener("keydown",
p,!0);b.classList.add("active");b.style.cssText="";if(f&&16/9*0.4*e.height/e.width>0.8)b.style.width=e.width/e.height*7.2/16*100+"%";if(a)a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.returnValue=!1,a.cancelBubble=!0;return!1}};u=function(a){if(!k(a)){b.classList.remove("active");b.style.width=f;if(d||r)b.style.top=d,b.style.left=r,b.style.position="absolute";e.style.width="100%";g.addEventListener("click",t,!1);window.removeEventListener("keydown",p,!0);window.removeEventListener("click",
c,!0);o||q.play();if(a)a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.returnValue=!1,a.cancelBubble=!0;return!1}};a.loaded=!1;b=document.createElement("div");b.setAttribute("class","image");b.id="image"+i;if(a.width)b.style.width=a.width;if(a.height)b.style.height=a.height;b.style.display="none";i++;if(document.getElementById(a.target))document.getElementById(a.target).appendChild(b);else throw"image target container doesn't exist";if(a.top||a.left)b.style.position=
"absolute",b.style.top=a.top,b.style.left=a.left;g=document.createElement("div");g.style.position="relative";b.appendChild(g);var s=function(){if(q.media&&q.media.buffered&&q.media.buffered.length){var b,c,i=!1,m,o,k=q.media.buffered;for(b=0,c=k.length;b<c;b++)if(m=k.start(b),o=k.end(b),m>q.media.duration&&(m=0),m<=a.end&&o>=a.start){i=!0;break}if(!i){setTimeout(s,10);return}}e=document.createElement("img");e.src=a.url;e.style.width="100%";g.appendChild(e);b=document.createElement("div");b.setAttribute("class",
"info");c=a.source||"Image";i=a.title;a.link&&(i='<a href="'+a.link+'" target="_new">'+i+"</a>",c='<a href="'+a.link+'" target="_new">'+c+"</a>");b.innerHTML='<div class="media"><span class="hiding minimize" style="float: right; margin-right: 20px;">minimize window</span>image<span class="hiding"> | <span class="popcorn-source">source</span>: '+c+"</span></div><div>"+i+'</div><div class="watch">view image</div>';b.getElementsByClassName("minimize").item(0).addEventListener("click",u,!1);g.appendChild(b);
f=a.width;d=a.top;r=a.left;e.addEventListener("load",function(){var b=/(\d*(\.\d*)?)\s*(px|em|\%|em|rem)?/,c,d,f;d=e.width||e.naturalWidth;f=e.height||e.naturalHeight;if(a.width&&!a.height&&(c=b.exec(a.width))&&c.length>1)if(b=c[3]||"",c=parseFloat(c[1]),c=c*e.height/e.width,g.style.height=c+b,!e.width)e.style.height=100*f/d+"%";a.loaded=!0},!1);g.addEventListener("click",t,!1)},m=a.end-a.start;if(isNaN(a.fadeIn))a.fadeIn=Math.min(0.25,m/8);else if(a.fadeIn>m)a.fadeIn=m;m-=a.fadeIn;if(isNaN(a.fadeOut))a.fadeOut=
Math.min(0.25,(a.end-a.start)/8);else if(a.fadeOut>m)a.fadeIn=m;s();return{start:function(a,c){var d=function(){c.loaded?b.style.display="":setTimeout(d,1)};d()},end:function(){b.style.display="none"},_teardown:function(a){(a=document.getElementById(a.target))&&a.removeChild(b)},frame:function(a,c,d){var a=d-c.start,e=1;a<c.fadeIn?e=a/c.fadeIn:d>c.end-c.fadeOut&&(e=(c.end-d)/c.fadeOut);b.style.opacity=e}}}},{about:{name:"Popcorn Image Plugin",version:"0.1",author:"Brian Chirls",website:"http://chirls.com/"},
options:{start:{elem:"input",type:"number",label:"In"},end:{elem:"input",type:"number",label:"Out"},target:"image-container",height:{elem:"input",type:"text",label:"Height"},width:{elem:"input",type:"text",label:"Width"}}})}})(window.Popcorn);(function(f){if(f){var k=0,i=function(a){var g=a.container=document.createElement("div"),e=g.style,l=a.media;i=f.nop;var d=function(){var f=a.position();e.fontSize="18px";e.width=l.offsetWidth+"px";e.top=f.top+l.offsetHeight-g.offsetHeight-40+"px";e.left=f.left+"px";setTimeout(d,10)};g.id="subtitlediv";e.position="absolute";e.color="white";e.textShadow="black 2px 2px 6px";e.fontWeight="bold";e.textAlign="center";d();document.body.appendChild(g)},a=function(a){if(a.languagesrc){if(typeof a.languagesrc===
"function")return a.languagesrc();if(a.languagesrc.tagName==="SELECT")return a.languagesrc.options[a.languagesrc.selectedIndex].value;if(a.languagesrc.value!==void 0)return a.languagesrc.value}};f.plugin("subtitle",{manifest:{about:{name:"Popcorn Subtitle Plugin",version:"0.1",author:"Scott Downe",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},target:"subtitle-container",text:{elem:"input",type:"text",label:"Text"},
fadeIn:{elem:"input",type:"text",label:"Text"},fadeOut:{elem:"input",type:"text",label:"Text"}}},_setup:function(b){var g=document.createElement("div"),e=document.getElementById(b.accessibilitysrc);g.id="subtitle-"+k;if(b.cssText)g.style.cssText=b.cssText;g.style.display="none";g.setAttribute("lang",b.language);k++;(!this.container&&!b.target||b.target==="subtitle-container")&&i(this);b.container=b.target&&b.target!=="subtitle-container"?document.getElementById(b.target):this.container;document.getElementById(b.container.id).appendChild(g);
b.innerContainer=g;b.showSubtitle=function(){b.innerContainer.innerHTML=b.text};b.toggleSubtitles=function(){};if(b.languagesrc){var f;if(typeof b.languagesrc==="string"&&(f=document.getElementById(b.languagesrc)))b.languagesrc=f;b.selectedLanguage=a(b);if(!this.languageSources)this.languageSources={};this.languageSources[b.languagesrc]||(this.languageSources[b.languagesrc]={});if(!this.languageSources[b.languagesrc][b.target]){this.languageSources[b.languagesrc][b.target]=!0;var d=this;this.updateSubtitleLanguage=
function(){b.toggleSubtitles();a(b);var e=d.currentTime(),g,f;for(g=d.data.trackEvents.startIndex-1,f=d.data.trackEvents.byStart;g>=0;g--){var c=f[g];if(c._natives.type!=="subtitle"||c.end<e)break;c.innerContainer.style.display=c.language===a(c)?"":"none";c.showSubtitle(c,c.text)}};b.languagesrc.addEventListener&&b.languagesrc.addEventListener("change",this.updateSubtitleLanguage,!1)}}if(e)b.accessibility=e,b.toggleSubtitles=function(){b.selectedLanguage=a(b);if(b.accessibility.checked||b.selectedLanguage!==
(b.language||""))b.display="",b.container.style.display=b.display;else if(b.selectedLanguage===(b.language||""))b.display="none",b.container.style.display=b.display},b.accessibility.addEventListener("change",b.toggleSubtitles,!1),b.toggleSubtitles();g=b.end-b.start;if(isNaN(b.fadeIn))b.fadeIn=Math.min(0.25,g/8);else if(b.fadeIn>g)b.fadeIn=g;g-=b.fadeIn;if(isNaN(b.fadeOut))b.fadeOut=Math.min(0.25,(b.end-b.start)/8);else if(b.fadeOut>g)b.fadeIn=g},start:function(b,g){if(g.language===a(g))g.innerContainer.style.display=
"",g.showSubtitle(g,g.text)},end:function(a,g){g.innerContainer.style.display="none";g.innerContainer.innerHTML=""},_teardown:function(a){a.container.removeChild(a.innerContainer)},frame:function(a,g,e){var a=e-g.start,f=1;a<g.fadeIn?f=a/g.fadeIn:e>g.end-g.fadeOut&&(f=(g.end-e)/g.fadeOut);g.innerContainer.style.opacity=f}})}})(window.Popcorn);(function(f){if(f){var k=0;f.plugin("videoComment",function(f){function a(a){return a<10?"0"+a:a}if(!f.text)return!1;var b,g,e=this;b=document.createElement("div");b.setAttribute("class","video-comment");b.id="video-comment"+k;b.style.display="none";b.setAttribute("lang",f.language);k++;if(document.getElementById(f.target))document.getElementById(f.target).appendChild(b);else throw"comment target container doesn't exist";var l,d=new Date(f.date);l=a(d.getMonth()+1)+"."+a(d.getDate());d.getFullYear()!==
(new Date).getFullYear()&&(l+="."+a(d.getFullYear()));var r=document.createElement("time");r.setAttribute("datetime",d.getUTCFullYear()+"-"+a(d.getUTCMonth()+1)+"-"+a(d.getUTCDate())+"T"+a(d.getUTCHours())+":"+a(d.getUTCMinutes())+":"+a(d.getUTCSeconds())+"Z");r.innerHTML=l;b.appendChild(r);l=document.createElement("span");l.setAttribute("class","author");l.appendChild(document.createTextNode(f.author||"Anonymous"));b.appendChild(l);l=document.createElement("p");var d=/https?:\/\/([a-zA-Z0-9\.]+\.[a-zA-Z]{2,6}[^\s\n\r\t$]*)/gi,
q;for(q=0;r=d.exec(f.text);)l.appendChild(document.createTextNode(f.text.substr(q,r.index-q))),q=document.createElement("a"),q.setAttribute("href",r[0]),q.setAttribute("target","_new"),r[1].length>20?q.appendChild(document.createTextNode(r[1].substr(0,17)+"...")):q.appendChild(document.createTextNode(r[1])),q.addEventListener("click",function(){g=!1;e.pause()},!0),l.appendChild(q),q=r.index+r[0].length;q<f.text.length&&l.appendChild(document.createTextNode(f.text.substr(q)));b.appendChild(l);l=document.createElement("div");
l.setAttribute("class","flag");l.appendChild(document.createTextNode("Flag this as inappropriate"));l.addEventListener("click",function(){var a=b.getAttribute("class"),a=a.split(" ");a.indexOf("flagged")<0&&(a.push("flagged"),b.setAttribute("class",a.join(" ")));f.flagCallback&&f.flagCallback(f.id)},!1);b.appendChild(l);l=document.createElement("div");l.setAttribute("class","unflag");l.appendChild(document.createTextNode("unflag this comment"));l.addEventListener("click",function(){var a,c=b.getAttribute("class"),
c=c.split(" ");a=c.indexOf("flagged");a>=0&&(c.splice(a,1),b.setAttribute("class",c.join(" ")));f.flagCallback&&f.flagCallback(f.id,!0)},!1);b.appendChild(l);b.addEventListener("mouseover",function(){var a=setTimeout(function(){g=!e.media.paused;e.media.pause()},500);b.onmouseout=function(){clearTimeout(a);g&&e.media.play()}},!1);return{start:function(){b.style.display=""},end:function(){b.style.display="none"},_teardown:function(a){document.getElementById(a.target)&&document.getElementById(a.target).removeChild(b)},
frame:function(a,c,d){var a=d-c.start,e=1,f=0;a<0.5?f=-207*(1-a/0.5)+"px":d>c.end-0.5&&(e=(c.end-d)/0.5);b.style.marginRight=f;b.style.opacity=e}}},{about:{name:"Popcorn Video Comments Plugin",version:"0.1",author:"Brian Chirls",website:"http://chirls.com/"},options:{start:{elem:"input",type:"number",label:"In"},end:{elem:"input",type:"number",label:"Out"}}})}})(window.Popcorn);(function(f){function k(a){if(!a)return!1;if(a.which)return a.which===3;if(a.button)return a.button===2}if(f){var i=0;f.plugin("wikipedia",function(a){var b,g,e,l,d,r,q,o=this,c=!1,t,u,p,s;if(a&&(a.url||a.id)){if(a.id)e=a.id,l=window.language||a.language||"en",a.url="http://en.wikipedia.org/wiki/"+e;else if(e=/(https?:\/\/)?((en)\.)?wikipedia\.org\/wiki\/(.*)\/?/.exec(a.url),l=window.language||a.language||e[3]||"en",e=e[4],!e)return;s=function(a){(a.keyCode||a.which)===27&&p()};t=function(a){if(!k(a)){var c=
a.target;do if(c===b)return!0;while(c=c.parentNode);console.log(a);p();return!1}};u=function(a){if(!k(a)){c=o.media.paused;o.pause();g.removeEventListener("click",u,!1);window.addEventListener("click",t,!0);window.addEventListener("keydown",s,!0);b.classList.add("active");b.style.cssText="";if(a)a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.returnValue=!1,a.cancelBubble=!0;return!1}};p=function(a){if(!k(a)){b.classList.remove("active");b.style.width=d;if(r||q)b.style.top=
r,b.style.left=q,b.style.position="absolute";g.addEventListener("click",u,!1);window.removeEventListener("keydown",s,!0);window.removeEventListener("click",t,!0);c||o.play();if(a)a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.returnValue=!1,a.cancelBubble=!0;return!1}};a.loaded=!1;b=document.createElement("div");b.setAttribute("class","wikipedia");b.id="wikipedia"+i;if(a.width)b.style.width=a.width;if(a.height)b.style.height=a.height;b.style.display="none";i++;if(document.getElementById(a.target))document.getElementById(a.target).appendChild(b);
else throw"wikipedia target container doesn't exist";if(a.top||a.left)b.style.position="absolute",b.style.top=a.top,b.style.left=a.left;g=document.createElement("div");g.style.position="relative";b.appendChild(g);f.xhr.getJSONP("http://"+l+".wikipedia.org/w/api.php?action=parse&props=text&page="+e+"&format=json&callback=wikipedia",function(b){if(b&&b.parse){var c=b.parse.text["*"],c=c.substr(c.indexOf("<p>")+3),c=c.substr(0,c.indexOf("</p>")),c=c.replace(/((<(.|\n)+?>)|(\((.*?)\) )|(\[(.*?)\]))/g,
""),e=[],i,k,o,s,e=e.concat(b.parse.images);for(s=0;s<e.length;s++)if(o=e[s].substr(-4).toLowerCase(),o===".jpg"){k=e[s];break}else o===".png"&&(i=e[s]);k||(k=i);var t=document.createElement("div");t.setAttribute("class","content");i=document.createElement("article");i.appendChild(document.createTextNode(c));t.appendChild(i);t.appendChild(document.createElement("br"));g.appendChild(t);c=document.createElement("div");c.setAttribute("class","info");b=b.parse.displaytitle;b=b.replace("<","&lt;");b=b.replace(">",
"&gt;");c.innerHTML='<div class="media"><span class="hiding minimize" style="float: right; margin-right: 20px;">minimize window</span>wiki<span class="hiding"> | <span class="popcorn-source">source</span>: <a href="'+a.url+'" target="_new">wikipedia</a></span></div><div><a href="'+a.url+'" target="_new">'+b+'</a></div><div class="watch">read article</div>';c.getElementsByClassName("minimize").item(0).addEventListener("click",p,!1);g.appendChild(c);d=a.width;r=a.top;q=a.left;g.addEventListener("click",
u,!1);k?(k="http://"+l+".wikipedia.org/w/api.php?action=query&prop=imageinfo&titles=File:"+k+"&iiprop=url|size&iiurlwidth=200&iiurlheight=200&format=json&callback=wikipediaImage",f.xhr.getJSONP(k,function(b){var c;b.query.pages&&b.query.pages[0]&&(c=b.query.pages[0].imageinfo[0]);if(c)b=document.createElement("img"),b.src=c.thumburl||c.url,b.onload=function(){a.loaded=!0},t.insertBefore(b,t.firstChild)})):a.loaded=!0}});e=a.end-a.start;if(isNaN(a.fadeIn))a.fadeIn=Math.min(0.25,e/8);else if(a.fadeIn>
e)a.fadeIn=e;e-=a.fadeIn;if(isNaN(a.fadeOut))a.fadeOut=Math.min(0.25,(a.end-a.start)/8);else if(a.fadeOut>e)a.fadeIn=e;return{start:function(a,c){var d=function(){c.loaded?b.style.display="":setTimeout(d,1)};d()},end:function(){b.style.display="none"},_teardown:function(a){(a=document.getElementById(a.target))&&a.removeChild(b)},frame:function(a,c,d){var a=d-c.start,e=1;a<c.fadeIn?e=a/c.fadeIn:d>c.end-c.fadeOut&&(e=(c.end-d)/c.fadeOut);b.style.opacity=e}}}},{about:{name:"Popcorn Wikipedia Plugin",
version:"0.1",author:"Brian Chirls",website:"http://chirls.com/"},options:{start:{elem:"input",type:"number",label:"In"},end:{elem:"input",type:"number",label:"Out"},url:{elem:"input",type:"text",label:"url"},target:"wikipedia-container"}})}})(window.Popcorn);(function(f){function k(a){if(!a)return!1;if(a.which)return a.which===3;if(a.button)return a.button===2}if(f){var i=0,a=!1,b=!1,g=function(){if(document.body){a=!0;var e=window.onYouTubePlayerAPIReady;window.onYouTubePlayerAPIReady=function(){b=!0;e&&e()};f.getScript("http://www.youtube.com/player_api")}else setTimeout(function(){g()},1)};f.plugin("youtube",function(e){var l,d,r,q,o,c,t,u=this,p=!1,s,m,j,x;a||g();x=function(a){var b=a.keyCode||a.which;if(b===27)j();else{if(b===32)t&&t.pauseVideo&&
(t.getPlayerState()===1?t.pauseVideo():t.getPlayerState()===2&&t.playVideo()),a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.returnValue=!1,a.cancelBubble=!0;return!1}};s=function(a){if(!k(a)){var b=a.target;do if(b===l)return!0;while(b=b.parentNode);console.log(a);j();return!1}};m=function(a){if(!k(a)){p=u.media.paused;u.pause();d.removeEventListener("click",m,!1);window.addEventListener("click",s,!0);window.addEventListener("keydown",x,!0);l.classList.add("active");
l.style.cssText="";t&&t.playVideo&&t.playVideo();if(a)a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.returnValue=!1,a.cancelBubble=!0;return!1}};j=function(a){if(!k(a)){t&&t.pauseVideo&&t.pauseVideo();l.classList.remove("active");l.style.width=r;if(q||o)l.style.top=q,l.style.left=o,l.style.position="absolute";d.addEventListener("click",m,!1);window.removeEventListener("keydown",x,!0);window.removeEventListener("click",s,!0);p||u.play();if(a)a.preventDefault&&a.preventDefault(),
a.stopPropagation&&a.stopPropagation(),a.returnValue=!1,a.cancelBubble=!0;return!1}};e.loaded=!1;l=document.createElement("div");l.setAttribute("class","youtube");l.id="youtube"+i;if(e.width)l.style.width=e.width;if(e.height)l.style.height=e.height;l.style.display="none";i++;if(document.getElementById(e.target))document.getElementById(e.target).appendChild(l);else throw"youtube target container doesn't exist";if(e.top||e.left)l.style.position="absolute",l.style.top=e.top,l.style.left=e.left;d=document.createElement("div");
d.style.position="relative";l.appendChild(d);var B=function(){if(u.media&&u.media.buffered&&u.media.buffered.length){var a,g,i=!1,k,l,h=u.media.buffered;for(a=0,g=h.length;a<g;a++)if(k=h.start(a),l=h.end(a),k>u.media.duration&&(k=0),k<=e.end&&l>=e.start){i=!0;break}if(!i){setTimeout(B,10);return}}c="http://gdata.youtube.com/feeds/api/videos/"+e.videoid+"?v=2&alt=jsonc&callback=youtube";f.xhr.getJSONP(c,function(a){if(a&&a.data){var c=a.data;(a=e.url)||(a="http://www.youtube.com/watch?v="+c.id);var f=
document.createElement("img");f.src=c.thumbnail.hqDefault;f.style.width="100%";d.appendChild(f);var g=document.createElement("div");g.id="ytplayer-"+c.id;g.setAttribute("class","player");d.appendChild(g);var h=function(){b?t=new window.YT.Player("ytplayer-"+c.id,{height:320,width:240,videoId:c.id,playerVars:{origin:document.location.protocol+"//"+document.location.hostname,html5:1},events:{onReady:function(){}}}):setTimeout(h,1)},g=document.createElement("div");g.setAttribute("class","info");g.innerHTML=
'<div class="media">video<span class="hiding"> | <span class="popcorn-source">source</span>: <a href="'+a+'" target="_new">YouTube</a></span></div><div><a href="'+a+'" target="_new">'+c.title+'</a></div><div class="watch">watch video</div>';d.appendChild(g);a=document.createElement("span");a.innerHTML="minimize window";a.setAttribute("class","minimize");a.addEventListener("click",j,!1);d.appendChild(a);h();r=e.width;q=e.top;o=e.left;f.addEventListener("load",function(){var a=/(\d*(\.\d*)?)\s*(px|em|\%|em|rem)?/,
b,c,g;c=f.width||f.naturalWidth;g=f.height||f.naturalHeight;if(e.width&&!e.height&&(b=a.exec(e.width))&&b.length>1)if(a=b[3]||"",b=parseFloat(b[1]),b=b*f.height/f.width,d.style.height=b+a,!f.width)f.style.height=100*g/c+"%";e.loaded=!0},!1);d.addEventListener("click",m,!1)}})};if(e.url&&!e.videoid){var z=/^(https?:\/\/)?(www\.)?(youtube\.com\/watch\?v=|youtu\.be\/)([A-Za-z0-9_\-]*)/i.exec(e.url);if(z&&z.length>=5)e.videoid=z[4]}z=e.end-e.start;if(isNaN(e.fadeIn))e.fadeIn=Math.min(0.25,z/8);else if(e.fadeIn>
z)e.fadeIn=z;z-=e.fadeIn;if(isNaN(e.fadeOut))e.fadeOut=Math.min(0.25,(e.end-e.start)/8);else if(e.fadeOut>z)e.fadeIn=z;e.videoid&&B();return{start:function(a,b){var c=function(){b.loaded?l.style.display="":setTimeout(c,1)};c()},end:function(){l.style.display="none";j()},_teardown:function(a){j();(a=document.getElementById(a.target))&&a.removeChild(l)},frame:function(a,b,c){if(b.loaded){var a=c-b.start,d=1;a<b.fadeIn?d=a/b.fadeIn:c>b.end-b.fadeOut&&(d=(b.end-c)/b.fadeOut);l.style.opacity=d}}}},{about:{name:"Popcorn YouTube Plugin",
version:"0.1",author:"Brian Chirls",website:"http://chirls.com/"},options:{start:{elem:"input",type:"number",label:"In"},end:{elem:"input",type:"number",label:"Out"},target:"youtube-container",height:{elem:"input",type:"text",label:"Height"},width:{elem:"input",type:"text",label:"Width"},top:{elem:"input",type:"text",label:"Top"},left:{elem:"input",type:"text",label:"Left"}}})}})(window.Popcorn);(function(f){if(f){var k={start:function(){},end:function(){}};f.plugin("words",function(f){var a,b,g,e,l,d;if(!f)return k;if(!f.target||!f.text)return k;a=this.media;b=f.target;if(typeof b==="string"&&(b=document.getElementById(b),!b))return k;g=document.createElement("div");g.style.cssText=f.style||"";if((d=f.top)||d===0)isNaN(d)||(d+="px"),g.style.top=d,g.style.position="absolute";if((d=f.left)||d===0)isNaN(d)||(d+="px"),g.style.left=d,g.style.position="absolute";if((d=f.right)||d===0)isNaN(d)||
(d+="px"),g.style.right=d,g.style.position="absolute";if((d=f.bottom)||d===0)isNaN(d)||(d+="px"),g.style.bottom=d,g.style.position="absolute";if(f.align)g.style.textAlign=f.align;g.style.display="none";f.classes?f.classes.length&&f.classes.join?g.setAttribute("class","popcorn-words "+f.classes.join(" ")):g.setAttribute("class","popcorn-words "+f.classes.split(/,\s\n\r/).join(" ")):g.setAttribute("class","popcorn-words");f.link?(e=document.createElement("a"),e.setAttribute("href",f.link),f.linkTarget&&
e.setAttribute("target",f.linkTarget),e.addEventListener("click",function(){a.pause()},!1),g.appendChild(e)):e=g;l=f.text.split(/[\n\r]/);for(d=0;d<l.length;d++)d&&e.appendChild(document.createElement("br")),e.appendChild(document.createTextNode(l[d]));b.appendChild(g);f.container=g;(function(){var a,b,d=["onLoad","onStart","onFrame","onEnd"];for(a=0;a<d.length;a++)b=d[a],f[b]&&typeof f[b]==="string"&&window[f[b]]&&typeof window[f[b]]==="function"&&(f[b]=window[f[b]])})();if(typeof f.onLoad==="function")f.onLoad(f);
return{start:function(a,b){g.style.display="";if(typeof b.onStart==="function")try{b.onStart(b)}catch(d){}},frame:function(a,b,d){if(typeof b.onFrame==="function")try{b.onFrame(b,d)}catch(c){}},end:function(a,b){g.style.display="none";if(typeof b.onEnd==="function")try{b.onEnd(b)}catch(d){}},_teardown:function(a){g.parentNode&&(g.parentNode.removeChild(g),g=null,delete a.container)}}},{about:{name:"Popcorn Words Plugin",version:0.1,author:"Brian Chirls",website:"http://chirls.com"},options:{start:{elem:"input",
type:"text",label:"In"},end:{elem:"input",type:"text",label:"Out"},text:{elem:"input",type:"text",label:"Text"},link:{elem:"input",type:"text",label:"Link (URL)"},classes:{elem:"input",type:"text",label:"List of classes to apply to text container"},style:{elem:"input",type:"text",label:"CSS to apply to text"},align:{elem:"select",label:"CSS to apply to text"},top:{elem:"input",type:"number",label:"Top position"},left:{elem:"input",type:"number",label:"Left position"},bottom:{elem:"input",type:"number",
label:"Bottom position"},right:{elem:"input",type:"number",label:"Right position"}}})}})(window.Popcorn);(function(f){function k(a){var a=Math.floor(a),b=a%60,a=(a-b)/60;b<10&&(b="0"+b);if(a>59){var c=Math.floor(a/60);a%=60;a<10&&(a="0"+a);return c+":"+a+":"+b}return a+":"+b}function i(a,b,c,d){var e,f,g=[],j=[],i,k,l=Date.now(),m,n;typeof a==="string"&&(a=h.getElementById(a));if(a)if(Modernizr.cssanimations){a.style.MozTransitionProperty="";a.style.webkitTransitionProperty="";a.style.oTransitionProperty="";a.style.transitionProperty="";for(e in b){f=b[e];g.push(e);if(f.from!==void 0)a.style[e]=f.from;
j.push(f.to)}i=g.join(",");setTimeout(function(){a.style.MozTransitionProperty=i;a.style.webkitTransitionProperty=i;a.style.oTransitionProperty=i;a.style.transitionProperty=i;a.style.MozTransitionDuration=c+"s";a.style.webkitTransitionDuration=c+"s";a.style.oTransitionDuration=c+"s";a.style.transitionDuration=c+"s";d&&(m=function(){d();a.removeEventListener("transitionend",m,!0);a.removeEventListener("webkitTransitionEnd",m,!0);a.removeEventListener("oTransitionEnd",m,!0)},a.addEventListener("transitionend",
m,!0),a.addEventListener("webkitTransitionEnd",m,!0),a.addEventListener("oTransitionEnd",m,!0));for(e=0;e<g.length;e++)a.style[g[e]]=j[e]},0)}else{k=/(\d*(\.\d*)?)\s*(px|em|\%|em|rem)?/;for(e in b)if(f=b[e],(i=k.exec(f.from))&&i.length>1&&i[1])g.push({prop:e,from:parseFloat(i[1]),to:parseFloat(f.to),unit:i[3]}),a.style[e]=f.from;n=function(){var b=(Date.now()-l)/1E3,e=Math.min(b/c,1),f,h,S;for(f=0,h=g.length;f<h;f++)S=g[f],a.style[S.prop]=S.from+e*(S.to-S.from)+(S.unit||"");b<c?oa(n,a):d&&d()};n()}}
function a(a,b,c,d){a.onmousedown=function(a){if(b)if(b(a||f.event)&&a.preventDefault)a.preventDefault();else return;if(c)h.onmousemove=function(a){c(a||f.event)};h.onmouseup=function(a){d&&d(a||f.event);h.onmousemove=null;h.onmouseup=null}};a.ontouchstart=function(e){e.preventDefault&&e.preventDefault();a.onmousedown=null;b&&b(e.touches[0]||f.event);if(c)h.ontouchmove=function(a){c(a.touches[0]||f.event);return!1};h.ontouchend=function(){d&&d();h.ontouchmove=null;h.ontouchend=null}}}function b(a){var b,
c;if(a)if(a.pageX!==void 0||a.pageY!==void 0)b=a.pageX,c=a.pageY;else if(a.clientX!==void 0||a.clientY!==void 0)b=a.clientX+h.body.scrollLeft+h.documentElement.scrollLeft,c=a.clientY+h.body.scrollTop+h.documentElement.scrollTop;return{x:b,y:c}}function g(a,b){var c=b;a.x-=b.clientLeft+b.offsetLeft;for(a.y-=b.clientTop+b.offsetTop;(c=c.offsetParent)&&c.nodeName!=="BODY";)a.x-=c.clientLeft+c.offsetLeft,a.y-=c.clientTop+c.offsetTop}function e(){if(ga){var a=O.height-17,b=a*(1-n.volume),c=ga;c.shadowOffsetX=
0;c.shadowOffsetY=0;c.shadowBlur=0;c.clearRect(0,0,O.width,O.height);c.lineWidth=7;c.lineCap="round";var d=c.createLinearGradient(0,0,7,0);d.addColorStop(0,"rgba(112, 112, 112, 0.38)");d.addColorStop(1,"rgba(241, 241, 241, 0.38)");c.strokeStyle=d;c.beginPath();c.moveTo(8.5,8.5);c.lineTo(8.5,a+8.5);c.stroke();b+=8.5;c.strokeStyle="rgba(0, 0, 0, 0.3)";c.beginPath();c.moveTo(8.5,8.5);c.lineTo(8.5,b);c.stroke();c.beginPath();c.lineWidth=1;c.strokeStyle="rgb(96, 96, 96)";c.fillStyle="rgb(128, 128, 128)";
c.shadowOffsetX=1;c.shadowOffsetY=2;c.shadowBlur=5;c.shadowColor="rgba(0, 0, 0, 0.19)";c.arc(8.5,b,8.5,0,Math.PI*2,!0);c.fill();c.shadowOffsetX=0;c.shadowOffsetY=0;c.shadowBlur=0;c.beginPath();c.fillStyle="#02fdca";c.arc(8.5,b,3.5,0,Math.PI*2,!0);c.fill()}}function l(a){if(n.duration&&$&&(a||!(wa===n.currentTime&&n.networkState>=4))){var b=D.width-17,a=b*n.currentTime/n.duration,c=$;c.shadowOffsetX=0;c.shadowOffsetY=0;c.shadowBlur=0;c.clearRect(0,0,D.width,D.height);c.lineWidth=7;c.lineCap="round";
var d=c.createLinearGradient(0,0,0,7);d.addColorStop(0,"rgba(112, 112, 112, 0.38)");d.addColorStop(1,"rgba(241, 241, 241, 0.38)");c.strokeStyle=d;c.beginPath();c.moveTo(8.5,8.5);c.lineTo(b+8.5,8.5);c.stroke();var d=[],e,f,h,i=n.buffered,j=0;if(i){for(e=0,f=i.length;e<f;e++)h=i.start(e),h>n.duration&&(h=0),h!==j&&d.push({start:j,end:h}),j=i.end(e);j!==n.duration&&d.push({start:j,end:n.duration})}if(aa){e=j===n.duration?0:Math.floor(Date.now()/40)%8;c.strokeStyle=aa[e];for(e=0,f=d.length;e<f;e++)j=
d[e].start/n.duration*b,h=d[e].end/n.duration*b,c.beginPath(),c.moveTo(j+8.5,8.5),c.lineTo(h+8.5,8.5),c.stroke()}a+=8.5;c.strokeStyle="rgba(0, 0, 0, 0.3)";c.beginPath();c.moveTo(8.5,8.5);c.lineTo(a,8.5);c.stroke();b={x:ba.x,y:ba.y};g(b,D);b=Math.sqrt(Math.pow(b.x-a,2)+Math.pow(b.y-8.5,2))-20;b=Math.max(0,b);if(b<100&&(b=8.5*(1-b/100),b*2>7))c.beginPath(),c.lineWidth=1,c.fillStyle="rgb(128, 128, 128)",c.shadowOffsetX=1,c.shadowOffsetY=2,c.shadowBlur=5,c.shadowColor="rgba(0, 0, 0, 0.19)",c.arc(a,8.5,
b,0,Math.PI*2,!0),c.fill(),c.shadowOffsetX=0,c.shadowOffsetY=0,c.shadowBlur=0;c.beginPath();c.fillStyle="#02fdca";c.arc(a,8.5,3.5,0,Math.PI*2,!0);c.fill()}}function d(a){var b=f.innerWidth||800,c=f.innerHeight||b*9/16;if(a||b!==pa||c!==qa||!D.width){pa=b;qa=c;var d=ha/ia/(b/c);d>1.2?(d=Math.min(1,(d-1.2)/0.25),c=Math.min(d*30,Math.max(b-640,0)*0.1),b=Math.floor(b-c*2)):(d<1/1.05?(d=Math.min(1,(1/1.05-d)/0.2),b=Math.min(d*40,Math.max(b-360,0)*0.1),b=Math.floor(c-b*2),b/=ia):b=Math.min(c/ia,b/ha),b=
Math.floor(ha*b));h.body.style.overflow=b<640?"auto":"";if(a||ra!==b){ra=b;var a=D.parentNode,b=a.offsetWidth,e;for(c=0,d=a.childNodes.length;c<d;c++)e=a.childNodes[c],e.tagName&&e!==D&&(ja[e.id]===void 0&&e.offsetWidth>0&&(ja[e.id]=e.offsetWidth+6),b-=ja[e.id]);D.width=b-6;l(!0)}}L=Date.now()}function r(a){if(Q&&(!a||!a.target||!(a.target!==a.currentTarget||a.target.classList.contains("button"))))h.getElementById("volume-controls").style.display="none",h.getElementById("settings-controls").style.display=
"none",h.getElementById("help-controls").style.display="none",h.getElementById("share-controls").style.display="none",Q=!1}function q(a){var b=h.getElementById("comment-name"),c=h.getElementById("comment-email"),d=h.getElementById("comment-text"),e=h.getElementById("comment-post"),f;f=c.value;var g,i;for(g=0;g<f.length;g++)if(" \n\r\t\u000c".indexOf(f.charAt(g))<0)break;for(i=f.length-1;i>=g;i--)if(" \n\r\t\u000c".indexOf(f.charAt(i))<0)break;f=f.substring(g,i+1);b=b.value.length;f=!f.length||xa.test(f);
if(a&&a.target===c)f?(h.getElementById("comment-email-invalid").style.display="none",c.classList.remove("error")):(h.getElementById("comment-email-invalid").style.display="block",c.classList.add("error"));b&=f;if(d.value.length>150){if(a&&a.target===d)a=h.getElementById("comment-letter-count"),a.innerHTML=150-d.value.length,a.classList.add("error")}else if(a&&a.target===d)a=h.getElementById("comment-letter-count"),a.innerHTML=150-d.value.length,a.classList.remove("error");(b=(b=b&&d.value.length<=
150)&&ca)?e.classList.remove("disabled"):e.classList.add("disabled");return b}function o(){if(V){var a=Date.now()-L;l(a<=100);Q&&a>5E3&&r();var b;if(n.paused||n.ended){if(sa!==(n.paused||n.ended))for(a=0,b=W.length;a<b;a++)W[a].style.opacity=1}else if(a<=5E3&&(a=ba,V)){b=0.4*ma.offsetWidth;var c=Math.max(0,1-(Date.now()-L)/5E3),d,e,f,h,i,j;for(d=0,e=W.length;d<e;d++)h=W[d],i=h.offsetWidth,j=h.offsetHeight,f={x:a.x,y:a.y},g(f,h),i=f.x<0?-f.x:f.x>i?f.x-i:0,f=f.y<0?-f.y:f.y>j?f.y-j:0,f=Math.sqrt(i*i+
f*f),f=1-0.8*(f/b),f<0.2?f=0.2:f>1&&(f=1),h.style.opacity=c*f}sa=n.paused||n.ended;n.duration?(a=k(n.currentTime),b=a+" / "+k(n.duration)):(a="-:--",b="-:-- / -:--");if(na.innerHTML!==b)na.innerHTML=b;if(H&&Z.innerHTML!==a)Z.innerHTML=a}oa(o,ma)}function c(){n.paused?n.play():n.ended?(n.currentTime=0,n.play()):n.pause()}function t(a){var b=h.getElementById(a+"-toggle");if(b)I[a]?(b.innerHTML=y==="de"?"ein":"On",b.classList.add("on")):(b.innerHTML=y==="de"?"aus":"Off",b.classList.remove("on"))}function u(){function a(b,
c){var d=new XMLHttpRequest;d.open("GET","comments.php?"+(c?"unflag":"flag")+"="+b,!0);d.send(null)}if(y){var b="comments.php?vtime="+(n.currentTime||0)+"&language="+y;if(da[y]){if(Date.now()-da[y]<5E3)return;b+="&since="+da[y]/1E3}var c=new XMLHttpRequest;c.open("GET",b,!0);c.onreadystatechange=function(){if(c.readyState===4&&c.status===200){var b=JSON.parse(c.responseText),d,e,f;for(d=0,e=b.length;d<e;d++)if((f=b[d])&&!ea[f[0]])ea[f[0]]=f,w.videoComment({start:f[2],end:f[2]+5,id:f[0],author:f[4],
text:f[5],date:f[1]*1E3,language:f[3],target:"comments",flagCallback:a})}};c.send(null);da[y]=Date.now()}}function p(a){!a&&F&&u();h.documentElement.setAttribute("lang",y);for(var b,c=["en","de"],a=0;a<c.length;a++)b=h.getElementById("language-"+c[a]),c[a]===y?b.classList.add("on"):b.classList.remove("on");var d,e,f,g;for(a in T)if(T.hasOwnProperty(a)){try{d=h.querySelectorAll(a)}catch(i){d=(d=h.getElementById(a.substr(1)))?[d]:[]}c=(T[a][y]||"").split("\n");for(f=0,g=d.length;f<g;f++)if((b=d[f])&&
c.length&&c[0].length){for(;b.firstChild;)b.removeChild(b.firstChild);try{b.appendChild(h.createTextNode(c[0]));for(e=1;e<c.length;e++)b.appendChild(h.createElement("br")),b.appendChild(h.createTextNode(c[e]))}catch(j){if(a==="#title")h.title=c.join(" ")}}}if(H){e=["comment-email","comment-name","comment-text"];b=[];d=[];for(a=0;a<e.length;a++)d.push(h.getElementById(e[a])),b.push(d[a].previousSibling.offsetWidth);for(a=0;a<e.length;a++)d[a].style.paddingLeft=b[a]+"px"}t("comments");t("subtitles");
t("resources");w&&w.updateSubtitleLanguage&&w.updateSubtitleLanguage()}function s(){H=!0;n.pause();if(Math.abs(X-n.currentTime)>10)h.getElementById("comment-text").value="";var a;a=n.duration?k(n.currentTime):"-:--";if(H&&Z.innerHTML!==a)Z.innerHTML=a;h.getElementById("add-comment-controls").style.display="block";p(!0)}function m(a){if(!a.altKey&&!a.altGraphKey&&!a.metaKey&&(L=Date.now(),!H)){var b=a.keyCode||a.which;b>=65&&b<=90||b>=97&&b<=122||b>=256&&b<=658||b>=884&&b<=8191?(a.preventDefault(),
s(),a=h.getElementById("comment-text"),a.value=String.fromCharCode(b),a.setSelectionRange(a.value.length,a.value.length),a.focus(),q()):(b===32&&(c(),a.preventDefault()),L=Date.now())}}function j(){var a=new XMLHttpRequest;a.open("GET","save.php?language="+y,!0);a.send(null)}function x(a){var b;if(a!==N){F?(n.pause(),r()):(b=h.getElementById("youtube-container"),n&&n.pauseVideo&&n.pauseVideo());f.location.hash=a||"";if(N)h.getElementById(N).style.display="none";if(a){if(b)b.style.display="none";if(!N&&
(h.getElementById("back-controls").style.display="block",h.getElementById("bottom-controls").style.display="none",P))P.style.display="block";h.getElementById(a).style.display="block";R.style.zIndex="1500";N=a}else if(N=!1,!N){if(n.currentTime>J)R.style.zIndex="";h.getElementById("back-controls").style.display="";h.getElementById("bottom-controls").style.display="";if(P)P.style.display="";if(b)b.style.display=""}}}function B(){var a,b=new Image;b.onload=function(){aa=[];var c=h.createElement("canvas");
c.height=7;c.width=8;var d=c.getContext("2d");for(a=0;a<8;a++)d.clearRect(0,0,8,7),d.drawImage(b,-a,0),d.drawImage(b,8-a,0),aa.push($.createPattern(c,"repeat"))};b.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAYAAAA1WQxeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAExJREFUeNpi/P//fzADA4MwAwLcAuIDUDYbE5DYDMRvkRSoAbEDlP0LpOAXPkWMQCtggmxA7ItuHRNUNQMuk5igRuFUxASlcSoCCDAA+ZwYM8U0vFEAAAAASUVORK5CYII=";var c=h.getElementsByClassName("fade");for(a=0;a<c.length;a++)W.push(c.item(a))}
function z(){function c(a){var e;a.which?e=a.which===3:a.button&&(e=a.button===2);if(e)return!1;r();d=d&&n.paused;a=b(a);g(a,D);a=(a.x-8.5)/(D.offsetWidth-17);a>=0&&a<=1&&(a*=n.duration,w.currentTime(a));n.pause();return!0}var d=!0;a(D,c,c,function(){d||(n.play(),d=!0)})}function C(){function c(a){var d;a.which?d=a.which===3:a.button&&(d=a.button===2);if(d)return!1;a=b(a);g(a,O);a=1-(a.y-8.5)/(O.offsetHeight-17);if(a>=0&&a<=1)n.volume=a;return!0}a(O,c,c,null)}function K(){if(A>n.duration)A=n.duration;
if(A)n.currentTime=A,ka||n.play(),V=!0;if(la)n.muted=!0;z();o()}function M(){var a,b,c,d,e=!1;c=f.location.pathname.split("/");c=c.concat(f.location.hash.substr(1).split("/"));for(d=c.length-1;d>=0;d--)if(a=c[d].toLowerCase(),a==="pause"?ka=!0:a==="mute"?la=!0:!b&&(a==="about"||a==="contact"||a==="disclaimer"||a==="terms-of-use")?b=a:!e&&a&&!isNaN(a)&&a>=0&&(e=!0,A=parseFloat(a)),b&&e&&la&&ka)break;if(fa=b)P?x(fa):E.style.display="none";else if(e&&n&&n.duration>A)n.currentTime=A}function G(){return y}
function v(){F=!1;A=0;h.getElementById("no-video").style.display="block";h.getElementById("intro-play").style.display="none";T["#intro-caption"]={en:"With the popcorn.js and HTML5 video technology on board, Europeana Remix is at the vanguard of using audiovisual heritage in engaging people with their history.",de:"Mit dem Popcorn.js und HTML5-Video-Technologie an Bord, ist Europeana Remix an der Spitze der Nutzung von Online-Video im Dialog mit Menschen mit ihrer Geschichte."};var a=h.createElement("script");
a.setAttribute("type","text/javascript");a.src="http://www.youtube.com/player_api";var b=h.createElement("div");b.id="youtube-container";b.style.display="none";E.insertBefore(b,h.getElementById("intro-text"));f.onYouTubePlayerAPIReady=function(){var a=navigator.userAgent.match(/iPad/i)?1:0;n=new f.YT.Player("youtube-container",{width:640,height:320,videoId:"8uLOWsWod7c",playerVars:{origin:h.location.protocol+"//"+h.location.hostname,html5:a}})};h.body.appendChild(a);h.getElementById("no-video-continue").onclick=
function(){h.getElementById("intro-text").style.display="none";b.style.display=""};h.body.classList.add("no-video")}var h=f.document,Y=f.Popcorn;h.getElementById("background");var va=h.getElementsByTagName("footer")[0],ma=h.getElementById("video-frame"),n=h.getElementById("video"),na=h.getElementById("play-timer"),Z=h.getElementById("add-comment-timer"),D=h.getElementById("progress"),O=h.getElementById("volume-canvas"),ga,$,E=h.getElementById("intro"),R=h.getElementById("eu-logo"),P,ta,ua,w,A=0,ka=
!1,la=!1,xa=RegExp("^[a-z0-9!#$%&'*+\\/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+\\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+(?:[A-Z]{2}|aero|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|pro|tel|travel|xxx)$","i"),oa=function(){return f.requestAnimationFrame||f.webkitRequestAnimationFrame||f.mozRequestAnimationFrame||f.oRequestAnimationFrame||f.msRequestAnimationFrame||function(a){f.setTimeout(a,16)}}(),wa,sa,L=0,da={},pa,qa,ra,N,fa,Q=!1,X=-10,ba={},F=!0,I={comments:!0,
resources:!0,subtitles:!0},V=!1,H=!1,ca=!1,ea={},U=[],y,T={"#title":{en:"A First World War friendship \u2013 an interactive HTML5 video by Europeana",de:"Eine Erste Weltkrieg Freundschaft - ein interaktiver HTML5 Video von Europeana"},"#about-button":{en:"About",de:"\u00fcber uns"},"#contact-button":{en:"Contact",de:"kontakt"},"#share-button":{en:"Share",de:"teilen"},"#comments-button-text":{en:"User Comments:",de:"User-Kommentare:"},"#resources-button-text":{en:"Related Items:",de:"relatierte Artikel:"},
"#subtitles-button-text":{en:"Subtitles:",de:"Untertitel"},"#language-button-text":{en:"Language:",de:"Sprache:"},"#back-button":{en:"Back to film",de:"Zur\u00fcck zum Film"},".popcorn-source":{en:"source",de:"Quelle"},"#write-comment-at":{en:"Write a comment at:",de:"Schreib einen Kommentar zu:"},"#comment-email-label":{en:"Email Address:",de:"E-Mail-Adresse:"},"#comment-text-label":{en:"Comment:",de:"Kommentar:"},"#comment-tos":{en:"I agree to terms of use",de:"Ich stimme den Nutzungsbedingungen zu"},
"#comment-post":{en:"Post My Comment",de:"absenden"},"#help-button":{en:"Help",de:"Hilfe"},"#help-window > div":{en:"Use this button:",de:"Diese taste dr\u00fccken:"},"#help-comment-p":{en:"(or just start typing) to leave a comment",de:"um einen Kommentar zu schreiben (oder fangen Sie einfach mit schreiben an)"},"#help-language-p":{en:"to change the language/subtitle settings",de:"Um die Sprache Untertitel-Einstellungen zu \u00e4ndern"},"#help-settings-p":{en:"to toggle subtitles, related items and comments on or off",
de:"um Untertitel, verwandte Artikel und Kommentare ein-oder auszuschalten"},"#intro-caption":{en:"An interactive experience around the story of an unlikely friendship during the First World War.",de:"Ein interaktives Erlebnis rund um die Geschichte einer ungew\u00f6hnlichen Freundschaft w\u00e4hrend des Ersten Weltkriegs."},"#no-video-browsers":{en:"Please be aware that for optimal performance, these browsers are recommended:",de:"Bitte beachten Sie, dass f\u00fcr eine optimale Leistung die folgenden Browser empfohlen sind:"},
"#no-video-continue-text":{en:"Click 'Continue' for the video without the interactive components.",de:"Klicken Sie auf 'Weiter\u2019 f\u00fcr das Video ohne die interaktiven Komponenten."},"#no-video-continue":{en:"Continue",de:"Weiter"},"#end-title":{en:"Like this story?\nHelp us build the next",de:"Gef\u00e4llt Ihnen diese Geschichte?\nHelfen Sie uns beim Aufbau der n\u00e4chsten!"},"#end-caption":{en:"Europeana wants to hear your family story about World War 1. Share your photos, letters and other memorabilia.",
de:"Europeana will Ihre Familiengeschichte \u00fcber den 1. Weltkrieg gerne h\u00f6ren. Teilen Sie Ihre Fotos, Briefe und andere Erinnerungsst\u00fccke."},"#play-again":{en:"Play Again",de:"wiederholen"},"#add-archive":{en:"Add to the Archive",de:"Mitmachen"},"#explore-archive":{en:"Explore the Archive",de:"Ansehen"},shareTwitter:{en:"Europeana Remix: an interactive video about an unlikely friendship in WW1 http://remix.europeana.eu #europeana",de:"Europeana Remix: ein interaktives Video \u00fcber eine ungew\u00f6hnliche Freundschaft in den 1. WK http://remix.europeana.eu #europeana"},
shareFacebook:{en:"Europeana Remix: an interactive video about an unlikely friendship in WW1",de:"Europeana Remix: ein interaktives Video \u00fcber eine ungew\u00f6hnliche Freundschaft in den 1. WK"}},ja={},W=[],aa,J=1.5,ha=1024,ia=576;(function(){M();f.addEventListener("hashchange",M,!1);if(!Modernizr||!Modernizr.video||navigator.userAgent.match(/iPad/i)!==null)v();else{w=Y("#video");try{ga=O.getContext("2d"),$=D.getContext("2d")}catch(a){}n.readyState>=2?K():n.addEventListener("loadedmetadata",
K,!1);if(h.body&&A>J)h.body.style.backgroundColor="#000"}d();if(A>J)h.body.style.backgroundColor="#000";y=h.documentElement.getAttribute("lang")||"en";p();F&&(C(),B(),n.addEventListener("play",function(){h.getElementById("play-button").classList.add("active");L=Date.now();if(!V)A<J&&i("bottom-controls",{opacity:{from:0,to:1}},0.5),h.getElementById("intro-play").style.display="none",n.style.display="block",V=!0},!1),n.addEventListener("pause",function(){h.getElementById("play-button").classList.remove("active");
L=Date.now()},!1),n.addEventListener("ended",function(){h.getElementById("play-button").classList.remove("active")},!1),n.addEventListener("volumechange",function(){h.getElementById("volume-button").offsetHeight&&e();n.volume<0.05?h.getElementById("volume-button").classList.add("active"):h.getElementById("volume-button").classList.remove("active");if(f.localStorage)localStorage.euRemixVolume=n.volume},!1));n.addEventListener("click",r,!1);h.getElementById("resources").addEventListener("click",r,!1);
h.getElementById("bottom-controls").addEventListener("click",r,!1);h.getElementById("top-controls").addEventListener("click",r,!1);h.getElementById("play-button").addEventListener("click",c,!1);h.addEventListener("click",function(){},!1);h.getElementById("intro-en").addEventListener("click",function(){y="en";p();j()},!1);h.getElementById("intro-de").addEventListener("click",function(){y="de";p();j()},!1);if(F)h.getElementById("comments-button").addEventListener("click",function(){I.comments=!I.comments;
t("comments");I.comments?w.enable("videoComment"):w.disable("videoComment")},!1),h.getElementById("resources-button").addEventListener("click",function(){var a,b;I.resources=!I.resources;t("resources");if(I.resources)for(a=0,b=U.length;a<b;a++)w.enable(U[a]);else for(a=0,b=U.length;a<b;a++)w.disable(U[a])},!1),h.getElementById("subtitles-button").addEventListener("click",function(){I.subtitles=!I.subtitles;t("subtitles");I.subtitles?w.enable("subtitle"):w.disable("subtitle")},!1),h.getElementById("language-en").addEventListener("click",
function(){y="en";p();j()},!1),h.getElementById("language-de").addEventListener("click",function(){y="de";p();j()},!1),h.getElementById("logo-link").addEventListener("click",function(){n.pause()},!1),h.getElementById("settings-button").addEventListener("click",function(){var a=h.getElementById("settings-controls"),b=!a.offsetHeight;r();if(b)a.style.display="block",Q=!0},!1),h.getElementById("volume-button").addEventListener("click",function(){var a=h.getElementById("volume-controls"),b=!a.offsetHeight;
r();if(b)a.style.display="block",e(),Q=!0},!1),h.getElementById("add-comment-button").addEventListener("click",function(){(H=!H)?s():(X=n.currentTime,h.getElementById("add-comment-controls").style.display="none")},!1),h.getElementById("comment-tos-checkbox").addEventListener("click",function(){ca=this.checked;q()},!1),ca=h.getElementById("comment-tos-checkbox").checked,h.getElementById("comment-post").addEventListener("click",function(){if(ca){var a=new XMLHttpRequest;a.open("POST","save-comment.php",
!0);var b,c=h.getElementById("comment-email").value,d=h.getElementById("comment-name").value,e=h.getElementById("comment-text").value;f.FormData?(b=new FormData,b.append("language",y),b.append("name",d),b.append("email",c),b.append("comment",e),b.append("time",n.currentTime)):(b=["language="+encodeURIComponent(y),"name="+encodeURIComponent(d),"email="+encodeURIComponent(c),"comment="+encodeURIComponent(e),"time="+encodeURIComponent(n.currentTime)].join("&"),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),
a.setRequestHeader("Content-length",b.length),a.setRequestHeader("Connection","close"));a.send(b);a.onreadystatechange=function(){if(a.readyState===4)if(a.status===200){var b=JSON.parse(a.responseText);if(b.success){if((b=b.data)&&!ea[b[0]])ea[b[0]]=b,w.videoComment({start:b[2],end:b[2]+5,id:b[0],author:b[4],text:b[5],date:b[1]*1E3,language:b[3],target:"comments"});H=!1;X=n.currentTime;h.getElementById("add-comment-controls").style.display="none";h.getElementById("comment-text").value=""}}else console.log("error saving comment")}}},
!1),h.getElementById("end-close").addEventListener("click",function(){h.getElementById("end").style.display="none"},!0),h.getElementById("play-again").addEventListener("click",function(){n.currentTime=0;n.play()},!0),h.getElementById("comment-cancel").addEventListener("click",function(){H=!1;X=n.currentTime;h.getElementById("add-comment-controls").style.display="none"},!0),h.getElementById("comment-name").addEventListener("change",q,!1),h.getElementById("comment-email").addEventListener("change",
q,!1),h.getElementById("comment-text").addEventListener("change",q,!1),h.getElementById("comment-name").addEventListener("keyup",q,!1),h.getElementById("comment-email").addEventListener("keyup",q,!1),h.getElementById("comment-text").addEventListener("keyup",q,!1);h.getElementById("about-button").addEventListener("click",function(){x("about")},!1);h.getElementById("contact-button").addEventListener("click",function(){x("contact")},!1);h.getElementById("back-button").addEventListener("click",function(){x()},
!1);h.getElementById("help-button").addEventListener("click",function(){var a=h.getElementById("help-controls"),b=!a.offsetHeight;r();if(b)a.style.display="block",Q=!0},!1);h.getElementById("share-button").addEventListener("click",function(){var a=h.getElementById("share-controls"),b=!a.offsetHeight;r();if(b)a.style.display="block",Q=!0},!1);h.getElementById("twitter-button").addEventListener("click",function(){var a=encodeURIComponent(f.location.protocol+"//"+f.location.host+f.location.pathname),
b=encodeURIComponent(T.shareTwitter[y]);ta=f.open("http://twitter.com/share?count=none&counturl="+a+"&text="+b+"&url=","europeanasharetweet","left="+Math.round(screen.width/2-275)+",top="+Math.round(screen.height/2-225)+",width=550,height=450,personalbar=0,toolbar=0,scrollbars=1,resizable=1");ta.focus();_gaq.push(["_trackSocial","twitter","tweet","remix.europeana.eu"])},!1);h.getElementById("facebook-button").addEventListener("click",function(){var a=f.location.protocol+"//"+f.location.host+f.location.pathname,
b=encodeURIComponent(T.shareFacebook[y]);ua=f.open("http://facebook.com/sharer.php?u="+a+"&t="+b,"europeanasharefacebook","left="+Math.round(screen.width/2-275)+",top="+Math.round(screen.height/2-225)+",width=550,height=450,personalbar=0,toolbar=0,scrollbars=1,resizable=1");ua.focus();_gaq.push(["_trackSocial","facebook","send","remix.europeana.eu"])},!1);i("top-controls",{opacity:{from:0,to:1}},0.5);f.addEventListener("load",function(){d(!0)},!1);f.addEventListener("resize",d,!0);h.addEventListener("mousemove",
function(a){L=Date.now();ba=b(a)},!1);var g=[{url:"image/page-bg.jpg",category:"display"},"image/background.jpg",{url:"css/style.css",mode:"font",id:"chevin",families:["Chevin-Light"],category:"display"},"image/bg.png","image/logo.png","image/icon_facebook.png","image/icon_twitter.png","image/radio.png","image/settings.png"];F&&(g=g.concat([{url:"video/otto-and-bernard.webm",element:n,id:"video",category:"play"},{url:"data/resources.txt?"+Date.now(),type:"json",category:"data",id:"resources"},{url:"data/subtitles.txt",
type:"json",category:"data",id:"subtitles"},"image/playpause.png","image/check.png","image/comment.png","image/comments.png","image/volume.png","image/intro-play.png","image/media-icons.png"]));g=new Loaderator(g,"all",function(){if(!F)return!1;if(A>J)i("bottom-controls",{opacity:{from:0,to:1}},0.5);else{var a=h.getElementById("intro-play");a.innerHTML='<img src="image/intro-play.png"/>';a.addEventListener("click",function(){va.innerHTML='<a href="http://www.europeana.eu" target="_blank"><img src="image/poweredby-white.png"/></a>';
n.play()},!1)}f.addEventListener("keypress",m,!1)});g.addEventListener("all:chevin",function(){d();A<J||!F?(i("intro-text",{opacity:{from:0,to:1}},1),i("intro-en",{opacity:{from:0,to:1}},1),i("intro-de",{opacity:{from:0,to:1}},1)):h.getElementById("intro-text").style.opacity=1});g.addEventListener("all:image/logo.png",function(){d();R.style.zIndex="1500";i(R,{opacity:{from:0,to:1}},1)});g.addEventListener("all:image/page-bg.jpg",function(a){a=a.element;a.id="page-background";P=a;E.parentNode.insertBefore(a,
E.nextSibling);if(!F)E.style.display="block"});g.addEventListener("display",function(){fa&&!N&&x(fa);if(A<J||!F)E.style.display="block"});g.addEventListener("all:image/background.jpg",function(a){d();a=a.element;E.insertBefore(a,E.firstChild);if(F){if(A<J){if(i(a,{opacity:{from:0,to:1}},1,function(){n.style.display="block"}),P)E.style.display="block"}else n.style.display="block";var b=h.getElementById("end"),a=a.cloneNode(!1);b.insertBefore(a,b.firstChild)}});F&&(g.addEventListener("all:video",function(a){a.element.style.visibility=
"visible";var b=h.getElementById("end"),c=h.getElementById("end-text"),d=h.getElementById("end-close"),e=b.firstChild;w.code({start:"4:26",end:w.duration()-1,onStart:function(){b.style.display="block";d.style.display=""},onFrame:function(a,c){var d=Math.min((w.currentTime()-c.start)/J,1);if(b.style.opacity!==d)b.style.opacity=d},onEnd:function(a){if(w.currentTime()<a.start)b.style.display="";d.style.display="none"}});w.code({start:w.duration()-1,end:w.duration(),onStart:function(){if(!(e instanceof
HTMLImageElement))e=b.firstChild;b.style.display="block";b.classList.add("final")},onFrame:function(a,d){var f=Math.min((w.currentTime()-d.start)/0.5,1);if(e.style.opacity!==f)e.style.opacity=f;if(b.style.opacity<f)b.style.opacity=f;f=1-f;c.style.backgroundColor="rgba(255, 255, 255, "+f*0.85+")";c.style.borderColor="rgba(0, 0, 0, "+f*0.6+")"},onEnd:function(){b.style.cssText="";b.classList.remove("final")}})}),g.addEventListener("data:resources",function(a){var b={flickr:f.flickrApiKey||""},a=JSON.parse(a.element.responseText),
c,d,e,g;for(c in a)if(a.hasOwnProperty(c)&&typeof w[c]==="function"){for(e=0,g=a[c].length;e<g;e++){d=a[c][e];if(b[c])d.apikey=b[c];d.target="resources";if(d.fadeIn===void 0||isNaN(d.fadeIn))d.fadeIn=0.5;if(d.fadeOut===void 0||isNaN(d.fadeOut))d.fadeOut=0.5;w[c](d)}g&&U.indexOf(c)===-1&&(U.push(c),I.resources||w.disable(c))}}),g.addEventListener("data:subtitles",function(a){var b=JSON.parse(a.element.responseText);if(b)for(a=0;a<b.length;a++)b[a].languagesrc=G,w.subtitle(b[a])}),u(),f.addEventListener("keyup",
function(a){var b=a.which||a.keyCode;if(H){if(L=Date.now(),b===27)H=!1,X=n.currentTime,h.getElementById("add-comment-controls").style.display="none",a.preventDefault()}else b===37?(n.currentTime-=0.04,console.log("left",n.currentTime)):b===39&&(n.currentTime+=0.04,console.log("right",n.currentTime))},!1),w.code({start:0,end:J,onStart:function(){E.style.display="block";h.body.style.backgroundColor="#fff";R.style.zIndex="1500"},onFrame:function(){var a=1-Math.min(w.currentTime()/J,1);E.style.opacity=
a;a=Math.round(a*255);h.body.style.backgroundColor="rgb("+a+", "+a+", "+a+")"},onEnd:function(){h.body.style.backgroundColor="#000";E.style.display="none";R.style.zIndex=""}}))})()})(window);
